<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Carrie Closet â€” 8BFR Music Network</title>
  <meta name="description" content="Customize your Carrie, James, or partner avatar with outfits, hair, accessories and more using 8BFR coins." />
  <link rel="icon" href="assets/images/favicon.png" />
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root {
      --ring: rgba(124,58,237,.55);
      --glass: rgba(12,6,24,.80);
    }

    html, body { scroll-behavior:smooth; }

    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(124,58,237,.30), transparent 60%),
        radial-gradient(900px 400px at 110% 10%, rgba(0,217,255,.22), transparent 60%),
        linear-gradient(#050011,#000);
      color:#eae6ff;
      margin:0;
      min-height:100vh;
      overflow-x:hidden;
    }

    header {
      position:relative;
      z-index:5;
      background:rgba(10,0,25,.96);
      border-bottom:1px solid rgba(124,58,237,.5);
      box-shadow:0 18px 40px rgba(0,0,0,.7);
    }

    .shell {
      border-radius:20px;
      border:1px solid rgba(129,140,248,.6);
      background:
        radial-gradient(circle at 0 0,rgba(76,29,149,.40),transparent 60%),
        radial-gradient(circle at 100% 0,rgba(14,165,233,.22),transparent 60%),
        rgba(10,6,30,.96);
      box-shadow:0 18px 50px rgba(0,0,0,.8);
    }

    /* --- Preview frame + layering (square 500Ã—500-style stage) --- */
    #closetPreviewFrame {
      width:100%;
      max-width:520px;
      margin:0 auto;
      border-radius:18px;
      border:1px solid rgba(148,163,255,.55);
      background:#020014;
      overflow:hidden;
      padding:14px 0;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    #closetPreviewInner {
      position:relative;
      width:100%;
      max-width:480px;
      aspect-ratio:1 / 1;     /* perfect for 500Ã—500 PNGs */
    }

    /* Base avatar stays full size */
    #closetBaseImg {
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:contain;
      display:block;
      z-index:1;
    }

    /* Overlay host */
    #closetOverlayHost {
      position:absolute;
      inset:0;
      pointer-events:none;
      z-index:2;
    }

    /* All overlays share these base settings */
    .layer-overlay {
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:contain;
      pointer-events:none;
      image-rendering:auto;
    }

    /* We now rely mostly on per-item transforms.
       Only ears/shoes still use these CSS-based left/right positions. */

    /* Earrings: two copies (left + right) */
    .layer-ears-left {
      transform-origin:center top;
      transform: scale(1) translate(-30%, -18%);
    }

    .layer-ears-right {
      transform-origin:center top;
      transform: scale(1) translate(30%, -18%);
    }

    /* Shoes: a pair, near feet */
    .layer-shoes-left {
      transform-origin:center bottom;
      transform: scale(1) translate(-20%, 30%);
    }

    .layer-shoes-right {
      transform-origin:center bottom;
      transform: scale(1) translate(20%, 30%);
    }

    .pill-tag {
      display:inline-flex;
      align-items:center;
      gap:.25rem;
      font-size:.7rem;
      border-radius:999px;
      padding:.15rem .6rem;
      border:1px solid rgba(129,140,248,.85);
      background:rgba(15,23,42,.9);
      text-transform:uppercase;
      letter-spacing:.08em;
    }

    .pill-tag-soft {
      border-color:rgba(147,197,253,.55);
      background:rgba(15,23,42,.85);
    }

    .seg-btn {
      font-size:11px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,255,.45);
      background:rgba(15,23,42,.85);
      cursor:pointer;
      color:#e5e7eb;
      transition:all .12s ease;
    }

    .seg-btn.active {
      border-color:#a855f7;
      background:linear-gradient(135deg,#7c3aed,#a855f7);
      color:#fff;
      box-shadow:0 0 0 1px rgba(129,140,248,.7),0 0 16px rgba(168,85,247,.65);
    }

    .seg-btn:hover {
      background:rgba(30,64,175,.85);
    }

    .tab-btn {
      font-size:11px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,255,.35);
      background:rgba(15,23,42,.8);
      cursor:pointer;
      color:#e5e7eb;
      transition:all .12s ease;
      white-space:nowrap;
    }

    .tab-btn.active {
      border-color:#38bdf8;
      background:radial-gradient(circle at 0 0,#38bdf8,#6366f1);
      color:#0f172a;
    }

    .closet-item-card {
      border-radius:12px;
      border:1px solid rgba(148,163,255,.4);
      background:rgba(15,23,42,.96);
      padding:.45rem .55rem;
      text-align:left;
      cursor:pointer;
      transition:transform .08s ease, box-shadow .08s ease, border-color .08s ease, background .08s ease;
      display:flex;
      gap:.45rem;
      align-items:center;
    }

    .closet-item-card:hover {
      transform:translateY(-1px);
      border-color:#a855f7;
      box-shadow:0 0 0 1px rgba(129,140,248,.85),0 0 18px rgba(124,58,237,.55);
      background:rgba(30,64,175,.85);
    }

    .closet-item-card.active {
      border-color:#22c55e;
      box-shadow:0 0 0 1px rgba(22,163,74,.8),0 0 18px rgba(22,163,74,.7);
      background:rgba(5,46,22,.92);
    }

    .closet-item-thumb {
      width:44px;
      height:44px;
      border-radius:10px;
      border:1px solid rgba(148,163,255,.4);
      background:#020617;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      flex-shrink:0;
    }

    .closet-item-thumb img {
      width:100%;
      height:100%;
      object-fit:contain;
      display:block;
    }

    #closetError {
      border-radius:999px;
      border:1px solid rgba(248,113,113,.8);
      background:rgba(127,29,29,.90);
      padding:.4rem .75rem;
      font-size:11px;
    }

    #closetEmpty {
      border-radius:999px;
      border:1px dashed rgba(148,163,255,.5);
      background:rgba(15,23,42,.86);
      padding:.4rem .75rem;
      font-size:11px;
    }

    /* Hide global Carrie avatar / bubbles on this page */
    #bubbleStack,
    #bubble-top-single,
    #carrieWrap,
    #globalAvatarSwitch {
      display:none !important;
    }

    #carrieToggleBar,
    .carrie-toggle-bar,
    #carrieModeButtons {
      display:none !important;
    }

    @media (max-width:768px){
      .shell { border-radius:16px; }
      #closetPreviewFrame {
        max-width:100%;
        padding:10px 0;
      }
      #closetPreviewInner {
        max-width:100%;
      }
    }
  </style>
</head>
<body data-no-global-carrie="true">
  <header class="px-4 py-4">
    <div class="max-w-6xl mx-auto flex items-center justify-between gap-3">
      <div class="flex items-center gap-3">
        <img src="assets/images/logo_8bfr.svg"
             alt="8BFR logo"
             class="h-9 w-auto"
             onerror="this.onerror=null;this.src='assets/images/8bfr.png'">
        <div>
          <h1 class="text-xl sm:text-2xl font-extrabold">
            <span class="text-[#a855f7]">Carrie Closet</span>
            <span class="text-xs sm:text-sm font-semibold align-middle ml-1 text-emerald-300/80">beta</span>
          </h1>
          <p class="text-[11px] text-purple-300/80 -mt-0.5">
            Dress your AI avatar for BF / GF chat and future upgrades.
          </p>
        </div>
      </div>
      <div class="flex flex-col items-end gap-1">
        <a href="carrie-chat.html"
           class="text-[#00d9ff] text-[11px] sm:text-xs underline/50 hover:underline">
          â¬… Back to Carrie Chat
        </a>
        <span class="pill-tag pill-tag-soft text-[10px]">
          <span>ðŸª™</span> Coins shop connects from here later
        </span>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 pb-10 pt-5">
    <div class="shell p-4 sm:p-5 lg:p-6">
      <div class="flex flex-col lg:flex-row gap-6 lg:gap-8">
        <!-- LEFT: Preview + base controls -->
        <section class="lg:w-[60%] space-y-4">
          <div class="flex items-center justify-between gap-2">
            <div class="flex flex-wrap items-center gap-2">
              <span class="pill-tag text-[10px]">
                ðŸ§¬ Avatar Preview
              </span>
              <span id="closetPreviewLabel" class="text-[11px] text-purple-200/80">
                Female â€¢ Light skin â€¢ Bikini base
              </span>
            </div>
            <span class="text-[10px] text-purple-200/80">
              BF / GF chat only
            </span>
          </div>

          <div id="closetPreviewFrame">
            <div id="closetPreviewInner">
              <img id="closetBaseImg"
                   src="assets/images/base/female/base_female_light.png"
                   alt="Avatar base">
              <div id="closetOverlayHost"></div>
            </div>
          </div>

          <div class="space-y-3 mt-2">
            <!-- Gender -->
            <div>
              <div class="flex items-center gap-2 mb-1">
                <span class="uppercase tracking-[0.16em] text-[9px] text-purple-200/75">
                  Gender
                </span>
              </div>
              <div class="flex gap-2">
                <button type="button"
                        class="seg-btn active"
                        data-gender="female">
                  â™€ Female
                </button>
                <button type="button"
                        class="seg-btn"
                        data-gender="male">
                  â™‚ Male
                </button>
              </div>
            </div>

            <!-- Skin tone -->
            <div>
              <div class="flex items-center gap-2 mb-1">
                <span class="uppercase tracking-[0.16em] text-[9px] text-purple-200/75">
                  Skin tone
                </span>
              </div>
              <div id="skinToneButtons" class="flex flex-wrap gap-2">
                <!-- Filled by JS -->
              </div>
            </div>
          </div>

          <p class="mt-3 text-[11px] text-purple-200/80">
            Tip: All outfits, hair, and accessories are drawn on the same canvas as the base,
            so what you see here will match BF / GF chat exactly.
          </p>
        </section>

        <!-- RIGHT: Filters + items -->
        <section class="lg:flex-1 space-y-3">
          <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
            <div class="flex flex-wrap items-center gap-2">
              <span class="pill-tag text-[10px]">
                ðŸ›’ Closet Items
              </span>
              <span id="closetGenderLabel" class="text-[11px] text-purple-200/85">
                Showing items for <b>Female</b> avatar
              </span>
            </div>
          </div>

          <!-- Category tabs -->
          <div class="flex flex-wrap gap-2 mt-1">
            <button type="button" class="tab-btn active" data-cat="hair">Hair</button>
            <button type="button" class="tab-btn" data-cat="top">Tops</button>
            <button type="button" class="tab-btn" data-cat="bottom">Bottoms</button>
            <button type="button" class="tab-btn" data-cat="jewelry">Jewelry</button>
            <button type="button" class="tab-btn" data-cat="eyes">Eyes</button>
            <button type="button" class="tab-btn" data-cat="shoes">Shoes</button>
            <button type="button" class="tab-btn" data-cat="all">All</button>
          </div>

          <!-- Error / empty messages -->
          <div id="closetError" class="hidden mt-2 text-red-50 text-[11px]">
            Closet data failed to load. Please check carrie-closet-data.js.
          </div>

          <div id="closetEmpty" class="hidden mt-2 text-purple-100/90 text-[11px]">
            No items for this category yet. Try switching categories or gender.
          </div>

          <!-- Items grid -->
          <div id="closetItemsGrid" class="mt-3 grid grid-cols-1 sm:grid-cols-2 gap-2.5">
            <!-- JS will inject cards -->
          </div>

          <p class="mt-3 text-[10px] text-purple-300/75">
            In the full release, each item will cost 8BFR coins and connect to your
            <a href="coinshop.html" class="underline text-sky-300 hover:text-sky-200">Coin Shop</a>.
            For now this is a visual beta so you can design outfits without charging coins.
          </p>
        </section>
      </div>
    </div>

    <p class="mt-4 text-[11px] text-purple-300/70 text-center max-w-3xl mx-auto">
      Default male base has shorts and no shirt. Default female base uses a bikini.
      Tops, bottoms, hair, eyes, jewelry, and shoes layer over those bases.
    </p>
  </main>

  <!-- Closet data + logic (DATA FIRST, then LOGIC) -->
  <script src="carrie-closet-data.js?v=10"></script>
  <script src="carrie-closet.js?v=11"></script>
</body>
</html>
