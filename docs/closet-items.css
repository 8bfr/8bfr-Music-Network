:root {
  --ring: rgba(124,58,237,.55);
  --glass: rgba(12,6,24,.80);
}

html, body { scroll-behavior: smooth; }

body {
  font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
  background:
    radial-gradient(1200px 600px at 10% -10%, rgba(124,58,237,.30), transparent 60%),
    radial-gradient(900px 400px at 110% 10%, rgba(0,217,255,.22), transparent 60%),
    linear-gradient(#050011,#000);
  color:#eae6ff;
  margin: 0;
  min-height: 100vh;
  overflow-x: hidden;
}

/* ============================= */
/* EARRING POSITION VARIABLES    */
/* ============================= */
body[data-gender="female"][data-skin="light"] {
  --ear-left-x: -6%;
  --ear-left-y: -6%;
  --ear-right-x: 6%;
  --ear-right-y: -20%;
  --ear-scale: 1;
}
body[data-gender="female"][data-skin="dark"] {
  --ear-left-x: 0%;
  --ear-left-y: 0%;
  --ear-right-x: 0%;
  --ear-right-y: 0%;
  --ear-scale: 1;
}

/* Base avatar width/height per gender/skin */
body[data-gender="female"][data-skin="light"]{ --base-width: .89; --base-height: .99; }
body[data-gender="female"][data-skin="dark"]{ --base-width: .63; --base-height: .96; }
body[data-gender="male"][data-skin="light"]{ --base-width: 1; --base-height: 1; }
body[data-gender="male"][data-skin="dark"]{ --base-width: .96; --base-height: 1; }

/* Header */
header {
  position: relative;
  z-index: 5;
  background: rgba(10,0,25,.96);
  border-bottom: 1px solid rgba(124,58,237,.5);
  box-shadow: 0 18px 40px rgba(0,0,0,.7);
}

/* Shell */
.shell {
  border-radius: 20px;
  border: 1px solid rgba(129,140,248,.6);
  background:
    radial-gradient(circle at 0 0, rgba(76,29,149,.40), transparent 60%),
    radial-gradient(circle at 100% 0, rgba(14,165,233,.22), transparent 60%),
    rgba(10,6,30,.96);
  box-shadow: 0 18px 50px rgba(0,0,0,.8);
}

/* Preview frame + dressing room background */
#closetPreviewFrame {
  width: 100%;
  max-width: 1100px;
  margin: 0 auto;
  border-radius: 18px;
  border: 1px solid rgba(148,163,255,0.55);
  overflow: hidden;
  height: 800px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-image: url("assets/images/closet/dressingroom.png?v=15");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  position: relative;
}

/* Inner canvas */
#closetPreviewInner {
  position: relative;
  width: 100%;
  max-width: 480px;
  height: 100%;
  transform: translateY(30px);
}

/* Base avatar */
#closetBaseImg {
  position: absolute;
  inset: 0;
  height: 100%;
  width: auto;
  object-fit: cover;
  display: block;
  z-index: 1;
  left: 50%;
  transform: translateX(-50%) scaleX(var(--base-width)) scaleY(var(--base-height));
  filter: drop-shadow(0 0 3px #000);
}

/* Overlay host */
#closetOverlayHost {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 2;
}

/* ============================= */
/* OVERLAY & EARRING FIXES       */
/* ============================= */

.layer-overlay {
  position: absolute;
  top: 0;
  left: 50%; /* anchor everything to avatar center */
  width: 100%;
  height: 100%;
  object-fit: contain;
  pointer-events: none;
  image-rendering: auto;

  /* default variables */
  --scale: 1;
  --offset-x: 0%;
  --offset-y: 0%;
  --scale-light: var(--scale);
  --offset-x-light: var(--offset-x);
  --offset-y-light: var(--offset-y);
  --scale-dark: var(--scale);
  --offset-x-dark: var(--offset-x);
  --offset-y-dark: var(--offset-y);
  --scale-use: var(--scale);
  --offset-x-use: var(--offset-x);
  --offset-y-use: var(--offset-y);
}

/* Skin-based variable overrides */
body[data-skin="light"] .layer-overlay {
  --scale-use: var(--scale-light);
  --offset-x-use: var(--offset-x-light);
  --offset-y-use: var(--offset-y-light);
}
body[data-skin="dark"] .layer-overlay {
  --scale-use: var(--scale-dark);
  --offset-x-use: var(--offset-x-dark);
  --offset-y-use: var(--offset-y-dark);
}

/* APPLY CENTERING AND OFFSET ONLY TO NON-EARRINGS */
.layer-overlay:not(.item-f_jewel_ears) {
  transform:
    translateX(-50%) translate(var(--offset-x-use), var(--offset-y-use)) scale(var(--scale-use));
}

/* Earrings stay side-specific */
.item-f_jewel_ears.layer-left {
  transform: translate(var(--ear-left-x), var(--ear-left-y)) scale(var(--ear-scale));
}
.item-f_jewel_ears.layer-right {
  transform: translate(var(--ear-right-x), var(--ear-right-y)) scale(var(--ear-scale));
}
