<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Profile ‚Äî 8BFR</title>
<link rel="icon" href="assets/images/favicon.png" />
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body{background:linear-gradient(#0b0014,#000);color:#eae6ff;font-family:system-ui;margin:0}
  header{background:rgba(15,0,30,.9);border-bottom:1px solid rgba(124,58,237,.5)}
  .card{border:1px solid rgba(124,58,237,.35);background:#0c0618;border-radius:14px;box-shadow:0 0 20px rgba(124,58,237,.18);padding:16px}
  .input{width:100%;padding:.55rem .7rem;background:#120327;color:#fff;border:1px solid rgba(124,58,237,.5);border-radius:.55rem}
  .btn{display:inline-block;background:#120327;border:1px solid rgba(124,58,237,.6);color:#eae6ff;padding:.55rem .9rem;border-radius:.7rem;text-decoration:none}
  .btn:hover{background:#190536}.btn-primary{background:#7c3aed;border-color:#7c3aed;color:#fff}
  .cover{height:180px;border-radius:14px;background:#120327 url('assets/images/bg_neon.png') center/cover no-repeat;border:1px solid rgba(124,58,237,.35)}
  .avatar{width:120px;height:120px;border-radius:16px;object-fit:cover;border:2px solid rgba(124,58,237,.5);background:#120327}
  .grid-auto{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
  .pill{display:inline-block;font-size:.75rem;border:1px solid rgba(124,58,237,.45);padding:.15rem .45rem;border-radius:9999px;background:#14072a}
  .row{display:flex;gap:.5rem;align-items:center}
</style>
</head>
<body>
<header class="px-4 py-4">
  <div class="max-w-6xl mx-auto flex items-center justify-between">
    <a href="index.html" class="btn">‚Üê Home</a>
    <h1 class="text-xl font-bold">Profile<span id="roleBadge" class="ml-2 pill"></span></h1>
    <a href="mailto:8bfr.music@gmail.com" class="text-[#00d9ff] hover:underline">Contact</a>
  </div>
</header>

<main class="max-w-6xl mx-auto px-4 py-5">
  <!-- Hero -->
  <div class="cover mb-4" id="coverView"></div>
  <div class="flex items-start gap-4 mb-6 flex-wrap">
    <img id="avatarView" class="avatar" src="assets/images/default_user_32_40.png" alt="Avatar">
    <div class="min-w-[240px]">
      <h2 id="nameView" class="text-2xl font-extrabold">8BFR</h2>
      <div id="tagView" class="text-purple-300/90">Tagline / Role</div>
      <div class="mt-2 flex flex-wrap gap-2 items-center">
        <a id="spotifyBtn" class="btn" target="_blank" rel="noopener" style="display:none">Spotify</a>
        <a id="websiteBtn" class="btn" target="_blank" rel="noopener" style="display:none">Website</a>
        <button id="shareBtn" class="btn">Share</button>
      </div>
    </div>
    <div class="ml-auto">
      <label class="pill">Profile ID: <span id="pid"></span></label>
    </div>
  </div>

  <!-- Editable Controls -->
  <div class="grid-auto">
    <!-- Basics -->
    <div class="card">
      <h3 class="font-bold mb-2">Basics</h3>
      <div class="grid sm:grid-cols-2 gap-3">
        <div><label>Name</label><input id="name" class="input" value="8BFR"></div>
        <div><label>Role</label>
          <select id="role" class="input">
            <option>artist</option><option>beatmaker</option><option>author</option>
            <option>dancer</option><option>influencer</option><option>fan</option>
          </select>
        </div>
        <div><label>Tagline</label><input id="tagline" class="input" value="Artist ‚Ä¢ Producer"></div>
        <div><label>Username (slug)</label><input id="slug" class="input" placeholder="8bfr"></div>
        <div class="sm:col-span-2"><label>Bio</label><textarea id="bio" class="input" rows="4" placeholder="Tell your story..."></textarea></div>
        <div><label>Avatar</label><input id="avatar" type="file" accept="image/*" class="input"></div>
        <div><label>Cover</label><input id="cover" type="file" accept="image/*" class="input"></div>
      </div>
      <div class="mt-3 flex gap-2">
        <button id="save" class="btn btn-primary">Save</button>
        <button id="reset" class="btn">Reset</button>
      </div>
    </div>

    <!-- Socials -->
    <div class="card">
      <h3 class="font-bold mb-2">Socials / Links</h3>
      <div class="grid sm:grid-cols-2 gap-3">
        <div><label>Spotify (artist URL)</label><input id="spotify" class="input" placeholder="https://open.spotify.com/artist/..."></div>
        <div><label>Website</label><input id="website" class="input" placeholder="https://"></div>
        <div><label>Instagram</label><input id="ig" class="input" placeholder="https://instagram.com/..."></div>
        <div><label>TikTok</label><input id="tt" class="input" placeholder="https://tiktok.com/@..."></div>
        <div><label>Facebook</label><input id="fb" class="input" placeholder="https://facebook.com/..."></div>
        <div><label>X / Twitter</label><input id="tw" class="input" placeholder="https://x.com/..."></div>
      </div>
    </div>

    <!-- Posts -->
    <div class="card">
      <h3 class="font-bold mb-2">Post</h3>
      <textarea id="postText" class="input" rows="3" placeholder="Say something..."></textarea>
      <input id="postMedia" class="input mt-2" type="file" accept="image/*,video/*">
      <button id="addPost" class="btn mt-2">Publish</button>
      <div id="feed" class="mt-3 space-y-3"></div>
    </div>

    <!-- Connections -->
    <div class="card">
      <h3 class="font-bold mb-2">Connections</h3>
      <div class="flex items-center gap-3 mb-2">
        <label class="flex items-center gap-2 text-sm opacity-90"><input id="hideNames" type="checkbox"> Hide names</label>
        <button data-k="followers" class="btn">+ Follower</button>
        <button data-k="following" class="btn">+ Following</button>
        <button data-k="friends" class="btn">+ Friend</button>
        <button data-k="favorites" class="btn">+ Favorite</button>
      </div>
      <div class="grid sm:grid-cols-2 gap-3 text-sm">
        <div><b>Followers</b><ul id="followers" class="list-disc pl-5"></ul></div>
        <div><b>Following</b><ul id="following" class="list-disc pl-5"></ul></div>
        <div><b>Friends</b><ul id="friends" class="list-disc pl-5"></ul></div>
        <div id="favoritesWrap" style="display:none"><b>Favorites</b><ul id="favorites" class="list-disc pl-5"></ul></div>
      </div>
    </div>

    <!-- ROLE: Artist / Beatmaker -->
    <div id="panel-music" class="card" style="display:none">
      <h3 class="font-bold mb-2">Tracks (Artist/Beatmaker)</h3>
      <div class="row mb-2">
        <input id="trackTitle" class="input" placeholder="Track title">
        <input id="trackUrl" class="input" placeholder="https:// (audio/stream or page)">
        <button id="addTrack" class="btn">Add</button>
      </div>
      <div class="row mb-2">
        <label>Featured Song URL</label>
        <input id="featuredSong" class="input" placeholder="https://open.spotify.com/track/... or your song page">
      </div>
      <ul id="tracks" class="mt-3 space-y-2 text-sm"></ul>
    </div>

    <!-- ROLE: Author -->
    <div id="panel-author" class="card" style="display:none">
      <h3 class="font-bold mb-2">Author ‚Äî Chapters/Manuscripts</h3>
      <div class="row mb-2">
        <input id="chapTitle" class="input" placeholder="Chapter / Work title">
        <input id="chapUrl" class="input" placeholder="https:// (doc / page)">
        <button id="addChap" class="btn">Add</button>
      </div>
      <ul id="chapters" class="mt-3 space-y-2 text-sm"></ul>
    </div>

    <!-- ROLE: Dancer -->
    <div id="panel-dancer" class="card" style="display:none">
      <h3 class="font-bold mb-2">Dancer ‚Äî Reels/Videos</h3>
      <div class="row mb-2">
        <input id="reelTitle" class="input" placeholder="Reel title">
        <input id="reelUrl" class="input" placeholder="https:// (video link)">
        <button id="addReel" class="btn">Add</button>
      </div>
      <ul id="reels" class="mt-3 space-y-2 text-sm"></ul>
    </div>

    <!-- ROLE: Influencer -->
    <div id="panel-influencer" class="card" style="display:none">
      <h3 class="font-bold mb-2">Influencer ‚Äî Campaigns</h3>
      <div class="row mb-2">
        <input id="campTitle" class="input" placeholder="Campaign title">
        <input id="campUrl" class="input" placeholder="https:// (campaign/brand link)">
        <button id="addCamp" class="btn">Add</button>
      </div>
      <ul id="campaigns" class="mt-3 space-y-2 text-sm"></ul>
    </div>
  </div>

  <!-- Spotify embed (if set) -->
  <div class="card mt-5" id="spotifyWrap" style="display:none">
    <h3 class="font-bold mb-2">Spotify</h3>
    <iframe id="spotifyEmbed" style="border-radius:12px" width="100%" height="152" frameborder="0"
      allow="autoplay; clipboard-write; encrypted-media; picture-in-picture" loading="lazy"></iframe>
  </div>
</main>

<script>
/* Helpers */
const $=s=>document.querySelector(s);
const get=(k,def)=>JSON.parse(localStorage.getItem(k)||JSON.stringify(def));
const set=(k,v)=>localStorage.setItem(k,JSON.stringify(v));
const toDataUrl=f=>new Promise(r=>{const fr=new FileReader();fr.onload=()=>r(fr.result);fr.readAsDataURL(f)});
const q=(n)=>new URLSearchParams(location.search).get(n);

/* Role + Storage key */
const roleParam=(q('role')||'artist').toLowerCase();
$('#role').value=roleParam;
const slugDefault='8bfr';
$('#slug').value=slugDefault;

function key(){ return `profile_${$('#role').value}_${($('#slug').value||slugDefault).toLowerCase()}`; }

/* UI show/hide per role */
function applyRoleUI(){
  const r=$('#role').value;
  $('#roleBadge').textContent=r;
  // panels
  $('#panel-music').style.display = (r==='artist'||r==='beatmaker')?'block':'none';
  $('#panel-author').style.display = (r==='author')?'block':'none';
  $('#panel-dancer').style.display = (r==='dancer')?'block':'none';
  $('#panel-influencer').style.display = (r==='influencer')?'block':'none';
  // favorites visible for fans (but any role can keep data)
  $('#favoritesWrap').style.display = (r==='fan')?'block':'';
}

/* Load */
function load(){
  applyRoleUI();
  const d=get(key(),{});
  $('#pid').textContent=key();
  // basics
  $('#name').value=d.name||'8BFR';
  $('#tagline').value=d.tagline||'';
  $('#slug').value=d.slug||slugDefault;
  $('#bio').value=d.bio||'';
  $('#nameView').textContent=$('#name').value;
  $('#tagView').textContent=$('#tagline').value||$('#role').value;
  if(d.avatarData) $('#avatarView').src=d.avatarData; else $('#avatarView').src='assets/images/default_user_32_40.png';
  if(d.coverData)  $('#coverView').style.backgroundImage=`url(${d.coverData})`;
  // socials
  $('#spotify').value=d.spotify||'';
  $('#website').value=d.website||'';
  $('#ig').value=d.ig||''; $('#tt').value=d.tt||''; $('#fb').value=d.fb||''; $('#tw').value=d.tw||'';
  // buttons & embed
  $('#spotifyBtn').style.display = d.spotify ? 'inline-block':'none';
  $('#spotifyBtn').href = d.spotify||'#';
  $('#websiteBtn').style.display = d.website ? 'inline-block':'none';
  $('#websiteBtn').href = d.website||'#';
  if(d.spotify && d.spotify.includes('open.spotify.com/artist/')){
    $('#spotifyWrap').style.display='block';
    $('#spotifyEmbed').src = d.spotify.replace('/artist/','/embed/artist/') + '?theme=0';
  } else { $('#spotifyWrap').style.display='none'; }

  // posts
  const feed=d.feed||[]; $('#feed').innerHTML=feed.map(p=>`<div class="border border-purple-400/30 rounded p-2">
    <div class="text-xs opacity-70">${new Date(p.ts).toLocaleString()}</div>
    <div class="mt-1">${p.text||''}</div>
    ${p.media?`<div class="mt-2"><img src="${p.media}" class="rounded max-h-48"></div>`:''}
  </div>`).join('');

  // connections
  const renderList=(arr)=> (arr||[]).map(n=>`<li>${$('#hideNames').checked?'Hidden':n}</li>`).join('');
  $('#followers').innerHTML = renderList(d.followers||[]);
  $('#following').innerHTML = renderList(d.following||[]);
  $('#friends').innerHTML   = renderList(d.friends||[]);
  $('#favorites').innerHTML = renderList(d.favorites||[]);

  // role data
  $('#tracks').innerHTML   = (d.tracks||[]).map(t=>`<li>üéµ <a class="text-blue-400" href="${t.url}" target="_blank" rel="noopener">${t.title}</a></li>`).join('');
  $('#featuredSong').value = d.featuredSong||'';
  $('#chapters').innerHTML = (d.chapters||[]).map(t=>`<li>üìÑ <a class="text-blue-400" href="${t.url}" target="_blank" rel="noopener">${t.title}</a></li>`).join('');
  $('#reels').innerHTML    = (d.reels||[]).map(t=>`<li>üé¨ <a class="text-blue-400" href="${t.url}" target="_blank" rel="noopener">${t.title}</a></li>`).join('');
  $('#campaigns').innerHTML= (d.campaigns||[]).map(t=>`<li>üì£ <a class="text-blue-400" href="${t.url}" target="_blank" rel="noopener">${t.title}</a></li>`).join('');
}
load();

/* Save / Reset */
$('#save').onclick = async ()=>{
  const d=get(key(),{});
  d.name=$('#name').value; d.tagline=$('#tagline').value; d.slug=$('#slug').value;
  d.bio=$('#bio').value; d.spotify=$('#spotify').value; d.website=$('#website').value;
  d.ig=$('#ig').value; d.tt=$('#tt').value; d.fb=$('#fb').value; d.tw=$('#tw').value;
  if($('#avatar').files[0]) d.avatarData=await toDataUrl($('#avatar').files[0]);
  if($('#cover').files[0])  d.coverData=await toDataUrl($('#cover').files[0]);
  set(key(),d); load(); alert('Saved locally üëç');
};
$('#reset').onclick=()=>{ localStorage.removeItem(key()); load(); };

/* Role change ‚Üí save under new key on next save */
$('#role').onchange=()=>{ applyRoleUI(); load(); };

/* Posts */
$('#addPost').onclick = async ()=>{
  const d=get(key(),{}); d.feed=d.feed||[];
  const text=$('#postText').value.trim(); let media=null;
  if($('#postMedia').files[0]) media=await toDataUrl($('#postMedia').files[0]);
  if(!text && !media) return;
  d.feed.unshift({text,media,ts:Date.now()}); set(key(),d);
  $('#postText').value=''; $('#postMedia').value=''; load();
};

/* Connections + Favorites */
document.querySelectorAll('[data-k]').forEach(btn=>{
  btn.onclick=()=>{ const k=btn.dataset.k; const name=prompt('Name/handle?'); if(!name) return;
    const d=get(key(),{}); d[k]=d[k]||[]; d[k].push(name); set(key(),d); load();
  };
});
$('#hideNames').onchange=load;

/* Music (artist/beatmaker) */
$('#addTrack')?.addEventListener('click',()=>{
  const title=$('#trackTitle').value.trim(), url=$('#trackUrl').value.trim(); if(!title||!url) return;
  const d=get(key(),{}); d.tracks=d.tracks||[]; d.tracks.push({title,url}); set(key(),d);
  $('#trackTitle').value=''; $('#trackUrl').value=''; load();
});
$('#featuredSong')?.addEventListener('change',()=>{
  const d=get(key(),{}); d.featuredSong=$('#featuredSong').value.trim(); set(key(),d);
});

/* Author */
$('#addChap')?.addEventListener('click',()=>{
  const title=$('#chapTitle').value.trim(), url=$('#chapUrl').value.trim(); if(!title||!url) return;
  const d=get(key(),{}); d.chapters=d.chapters||[]; d.chapters.push({title,url}); set(key(),d);
  $('#chapTitle').value=''; $('#chapUrl').value=''; load();
});

/* Dancer */
$('#addReel')?.addEventListener('click',()=>{
  const title=$('#reelTitle').value.trim(), url=$('#reelUrl').value.trim(); if(!title||!url) return;
  const d=get(key(),{}); d.reels=d.reels||[]; d.reels.push({title,url}); set(key(),d);
  $('#reelTitle').value=''; $('#reelUrl').value=''; load();
});

/* Influencer */
$('#addCamp')?.addEventListener('click',()=>{
  const title=$('#campTitle').value.trim(), url=$('#campUrl').value.trim(); if(!title||!url) return;
  const d=get(key(),{}); d.campaigns=d.campaigns||[]; d.campaigns.push({title,url}); set(key(),d);
  $('#campTitle').value=''; $('#campUrl').value=''; load();
});

/* Share */
$('#shareBtn').onclick=async()=>{
  const url=location.href.split('?')[0]+`?role=${encodeURIComponent($('#role').value)}`;
  if(navigator.share){ try{ await navigator.share({title:'8BFR Profile', url}); }catch{} }
  else { await navigator.clipboard.writeText(url); alert('Profile link copied!'); }
};
</script>
</body>
</html>
