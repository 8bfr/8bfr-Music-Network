<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Login — 8BFR Music Network</title>
  <meta name="description" content="Login to 8BFR Music Network." />
  <link rel="icon" href="assets/images/favicon.png" />
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --ring: rgba(124,58,237,.65);
      --glass: rgba(12,6,24,.88);
    }
    html,body{ scroll-behavior:smooth; }
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(124,58,237,.35), transparent 60%),
        radial-gradient(900px 400px at 110% 10%, rgba(0,217,255,.22), transparent 60%),
        linear-gradient(#0b0014,#000);
      color:#eae6ff;
      margin:0;
      min-height:100vh;
      display:flex;
      flex-direction:column;
    }
    header{
      position:relative;
      z-index:5;
      background:rgba(15,0,30,.9);
      border-bottom:1px solid rgba(124,58,237,.5);
    }
    .section-card{
      border:1px solid rgba(124,58,237,.35);
      background:#0c0618;
      border-radius:16px;
      box-shadow:0 0 24px rgba(124,58,237,.25);
    }
    .btn{
      display:inline-flex;
      justify-content:center;
      align-items:center;
      gap:.4rem;
      background:#120327;
      border:1px solid rgba(124,58,237,.6);
      color:#eae6ff;
      padding:.6rem .95rem;
      border-radius:.75rem;
      text-decoration:none;
      font-size:.9rem;
      cursor:pointer;
    }
    .btn-primary{
      background:#7c3aed;
      border-color:#7c3aed;
      color:#fff;
    }
    .btn-primary:hover{
      filter:brightness(1.05);
    }
    .btn-ghost{
      background:transparent;
    }
    .error-text{
      font-size:.8rem;
      color:#fecaca;
    }
    footer{
      border-top:1px solid rgba(124,58,237,.35);
      background:#050013cc;
      margin-top:auto;
    }
  </style>

  <!-- Supabase JS just for this page -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<!-- No global Carrie avatar on login (keeps it clean) -->
<body data-no-global-carrie="true">
  <header class="px-4 py-4">
    <div class="max-w-4xl mx-auto flex items-end justify-between gap-3">
      <div class="flex items-center gap-3">
        <img src="assets/images/logo_8bfr.svg"
             alt="8BFR logo"
             class="h-10 w-auto"
             onerror="this.onerror=null;this.src='assets/images/8bfr.png'">
        <div>
          <h1 class="text-2xl font-extrabold">
            8BFR <span class="text-[#00d9ff]">Music</span> Network
          </h1>
          <p class="text-[10px] text-green-300/90 font-mono">LOGIN</p>
          <p class="text-xs sm:text-sm text-purple-300/80 -mt-1">
            Sign in to unlock studio tools, profiles, and tournaments.
          </p>
        </div>
      </div>
      <a href="index.html"
         class="text-[#00d9ff] underline/50 hover:underline"
         style="position:relative;z-index:6">
        ← Back home
      </a>
    </div>
  </header>

  <main class="px-4 mt-8 mb-10">
    <div class="max-w-md mx-auto section-card p-6 sm:p-7">
      <h2 class="text-xl font-bold mb-2">Log in to your 8BFR account</h2>
      <p class="text-sm text-purple-200/90 mb-5">
        Use the email and password you signed up with. Your login gives you access to creator tools, profiles, coins, and more.
      </p>

      <form id="loginForm" class="space-y-4">
        <div>
          <label for="email" class="block text-sm mb-1">Email</label>
          <input
            id="email"
            type="email"
            required
            autocomplete="email"
            class="w-full rounded-lg border border-purple-500/70 bg-black/40 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-purple-400"
          />
        </div>

        <div>
          <label for="password" class="block text-sm mb-1">Password</label>
          <input
            id="password"
            type="password"
            required
            autocomplete="current-password"
            class="w-full rounded-lg border border-purple-500/70 bg-black/40 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-purple-400"
          />
        </div>

        <p id="loginError" class="error-text mb-1 hidden"></p>

        <button
          id="loginButton"
          type="submit"
          class="btn btn-primary w-full mt-2"
        >
          Log in
        </button>
      </form>

      <div class="mt-5 space-y-2 text-sm text-purple-100/90">
        <button
          type="button"
          id="forgotButton"
          class="btn btn-ghost w-full"
          onclick="window.location.href='reset-password.html';"
        >
          Forgot password?
        </button>

        <button
          type="button"
          class="btn btn-ghost w-full"
          onclick="window.location.href='signup.html';"
        >
          Need an account? Sign up free
        </button>

        <button
          type="button"
          class="btn btn-ghost w-full"
          onclick="window.location.href='index.html';"
        >
          Continue as guest (limited access)
        </button>
      </div>
    </div>
  </main>

  <footer class="px-4 py-4">
    <div class="max-w-4xl mx-auto text-center text-[11px] text-purple-300/80">
      © 2025 8BFR Music Network — “Empowering creators, connecting the world.”
    </div>
  </footer>

  <!-- Global UI (menu, bubbles, etc.) -->
  <script src="scripts.js?v=1ed5604" defer></script>

  <!-- Page-specific Supabase login logic -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById("loginForm");
      const emailInput = document.getElementById("email");
      const passwordInput = document.getElementById("password");
      const errorEl = document.getElementById("loginError");
      const button = document.getElementById("loginButton");

      if (!window.supabase || !window.supabase.createClient) {
        // Supabase library failed to load
        if (errorEl) {
          errorEl.textContent = "Login system is temporarily unavailable. Please try again in a moment.";
          errorEl.classList.remove("hidden");
        }
        return;
      }

      const SUPABASE_URL = "https://novbuvwpjnxwwvdekjhr.supabase.co";
      const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5vdmJ1dndwam54d3d2ZGVramhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjExODkxODUsImV4cCI6MjA3Njc2NTE4NX0.1UUkdGafh6ZplAX8hi7Bvj94D2gvFQZUl0an1RvcSA0";

      const { createClient } = window.supabase;
      const client = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        if (!emailInput.value || !passwordInput.value) return;

        errorEl.classList.add("hidden");
        errorEl.textContent = "";
        button.disabled = true;
        button.textContent = "Logging in…";

        try {
          const { data, error } = await client.auth.signInWithPassword({
            email: emailInput.value.trim(),
            password: passwordInput.value,
          });

          if (error) {
            errorEl.textContent = error.message || "Login failed. Please check your email and password.";
            errorEl.classList.remove("hidden");
            button.disabled = false;
            button.textContent = "Log in";
            return;
          }

          // success: go home (auth gate will allow more pages now)
          window.location.href = "index.html";
        } catch (err) {
          console.error("Login error", err);
          errorEl.textContent = "Something went wrong signing you in. Please try again.";
          errorEl.classList.remove("hidden");
          button.disabled = false;
          button.textContent = "Log in";
        }
      });
    });
  </script>
</body>
</html>
