<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>8BFR Music Network ‚Äî Create ‚Ä¢ Connect ‚Ä¢ Collab</title>
<meta name="description" content="Empowering creators, connecting the world ‚Äî 8BFR Music Network." />
<link rel="icon" type="image/png" href="assets/images/favicon.png" />

<!-- Tailwind (for responsive layout) -->
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = { theme:{ extend:{ colors:{ neon:'#00d9ff', purple:'#7c3aed', ink:'#0b0014' } } } }
</script>

<style>
  :root{ --ring: rgba(124,58,237,.55); --glass: rgba(12,6,24,.78); }
  html,body{scroll-behavior:smooth}
  body{
    background:
      radial-gradient(1200px 600px at 10% -10%, rgba(124,58,237,.35), transparent 60%),
      radial-gradient(900px 400px at 110% 10%, rgba(0,217,255,.22), transparent 60%),
      linear-gradient(#0b0014,#000);
    color:#eae6ff; overflow-x:hidden;
  }
  .marquee{overflow:hidden;white-space:nowrap}
  .marquee span{display:inline-block;padding-left:100%;animation:marq 18s linear infinite}
  @keyframes marq{0%{transform:translateX(0)}100%{transform:translateX(-100%)}}

  /* HERO */
  .hero{ position:relative; height:300px; border-radius:1rem; overflow:hidden;
         border:1px solid rgba(124,58,237,.4); box-shadow:0 0 24px rgba(124,58,237,.35); }
  .hero::before{ content:""; position:absolute; inset:0; background:url('assets/images/bg_neon.png') center/cover no-repeat;
                 filter:brightness(.8) saturate(1.1); }
  #hero-text{position:absolute; inset:0; display:grid; place-items:center; text-align:center; padding:0 1rem}
  #hero-line{font-weight:800; transition:opacity .25s ease, transform .25s ease}
  #hero-line.hide{opacity:0; transform:translateY(-8px)}

  /* Ad carousel (full width, one at a time) */
  .ad-frame{position:relative; overflow:hidden; border-radius:1rem; border:1px solid rgba(124,58,237,.4); background:#0c0618}
  .ad-track{display:flex; width:100%; height:260px; position:relative}
  .ad-slide{position:absolute; inset:0; display:grid; place-items:center; opacity:0; transform:translateX(20px);
            transition:opacity .35s ease, transform .35s ease}
  .ad-slide.show{opacity:1; transform:translateX(0)}
  .ad-slide img{display:block; width:100%; height:100%; object-fit:cover}
  .ad-btn{position:absolute; top:50%; transform:translateY(-50%); background:rgba(0,0,0,.4);
          border:1px solid rgba(124,58,237,.4); padding:.45rem .65rem; border-radius:.5rem}
  .ad-btn:hover{background:rgba(0,0,0,.55)}
  #adPrev{left:10px} #adNext{right:10px}
  #adPause{right:10px; bottom:10px; top:auto; transform:none}

  /* Cards / buttons */
  .section-card{ border:1px solid rgba(124,58,237,.35); background:#0c0618; border-radius:1rem; box-shadow:0 0 24px rgba(124,58,237,.15) }
  .btn{ display:inline-block; background:#120327; border:1px solid rgba(124,58,237,.6); color:#eae6ff; padding:.55rem .9rem; border-radius:.7rem }
  .btn:hover{ background:#190536 }

  /* Floating FAB (music note) */
  #hamburgerFab{
    position: fixed; top: 14px; right: 14px; z-index: 9999;
    width: 58px; height: 58px; border-radius: 9999px; display: grid; place-items: center; cursor: pointer;
    background: radial-gradient(120% 120% at 30% 20%, rgba(124,58,237,.85), rgba(10,10,20,.85));
    border: 1px solid rgba(124,58,237,.55);
    box-shadow: 0 0 18px rgba(124,58,237,.45), 0 0 22px rgba(0,217,255,.25) inset;
  }
  #hamburgerFab svg{ filter: drop-shadow(0 0 6px rgba(0,217,255,.8)); }

  /* Slide-in menu (transparent/narrow) */
  #sideMenu{
    position: fixed; top: 72px; right: 14px; width: min(90vw, 280px);
    max-height: calc(100vh - 88px); overflow-y: auto; z-index: 9998;
    transform: translateX(115%); transition: transform .25s ease;
    backdrop-filter: blur(10px); background: var(--glass);
    border:1px solid var(--ring); border-radius: 14px; box-shadow: 0 12px 30px rgba(0,0,0,.45);
  }
  #sideMenu.open{ transform: translateX(0); }
  #menuBackdrop{
    position: fixed; inset: 0; background: rgba(0,0,0,.25); backdrop-filter: blur(1px);
    z-index: 9990; opacity: 0; pointer-events: none; transition: opacity .2s ease;
  }
  #menuBackdrop.open{ opacity: 1; pointer-events: auto; }
  .menu-group{ margin: 8px 8px; border:1px solid rgba(124,58,237,.3); border-radius: 10px; overflow:hidden }
  .menu-group summary{ cursor: pointer; padding:8px 10px; background: rgba(124,58,237,.12) }
  .menu-group a{ display:block; padding:6px 10px; color:#eae6ff; text-decoration:none }
  .menu-group a:hover{ background: rgba(124,58,237,.16) }

  /* Carrie ‚Äî bigger, no circle, transparent look + fun modes */
  #carrieWrap{
    position: fixed; right:14px; bottom:16px; z-index: 9997; transition: transform .25s ease;
    user-select:none; touch-action:none;
  }
  #carrieWrap.aside{ transform: translateX(-300px); }
  #carrie{
    width:min(38vw, 220px); height:auto; border-radius:0; background:transparent !important;
    filter: drop-shadow(0 10px 28px rgba(124,58,237,.35)) drop-shadow(0 4px 10px rgba(0,0,0,.45));
    will-change: transform, opacity;
  }
  .carrie--bob { animation: carrie-bob 3.5s ease-in-out infinite; }
  @keyframes carrie-bob { 0%,100%{ transform: translateY(0) } 50%{ transform: translateY(-6px) } }
  .carrie--dance { animation: carrie-dance 1.25s ease-in-out infinite; }
  @keyframes carrie-dance {
    0%{ transform: translateY(0) rotate(-2deg) scale(1.00) }
    25%{ transform: translateY(-4px) rotate(2deg) scale(1.03) }
    50%{ transform: translateY(0) rotate(-2deg) scale(1.00) }
    75%{ transform: translateY(-4px) rotate(2deg) scale(1.03) }
    100%{ transform: translateY(0) rotate(-2deg) scale(1.00) }
  }
  .carrie--pace { animation: carrie-pace 10s ease-in-out infinite; }
  @keyframes carrie-pace {
    0%   { transform: translateX(0)   scaleX(1) }
    45%  { transform: translateX(-240px) scaleX(1) }
    50%  { transform: translateX(-240px) scaleX(-1) }
    95%  { transform: translateX(0)   scaleX(-1) }
    100% { transform: translateX(0)   scaleX(1) }
  }
  .carrie--wave { animation: carrie-wave 1.2s ease-in-out 6; }
  @keyframes carrie-wave {
    0%,100% { filter: drop-shadow(0 10px 28px rgba(124,58,237,.35)) drop-shadow(0 4px 10px rgba(0,0,0,.45)); }
    50%     { filter: drop-shadow(0 10px 28px rgba(0,217,255,.55)) drop-shadow(0 4px 10px rgba(0,0,0,.45)); }
  }
  .carrie-juggle { position:absolute; inset:0; pointer-events:none; }
  .carrie-coin { position:absolute; width:28px; height:28px;
    background:url('assets/images/icon_coin.png') center/contain no-repeat; opacity:.95; }
  .carrie-coin--a { animation: orbit-a 1.2s linear infinite; }
  .carrie-coin--b { animation: orbit-b 1.2s linear infinite .2s; }
  .carrie-coin--c { animation: orbit-c 1.2s linear infinite .4s; }
  @keyframes orbit-a { from{ transform: translate(60px,-30px) } to{ transform: rotate(360deg) translate(60px,-30px) } }
  @keyframes orbit-b { from{ transform: translate(42px,-58px) } to{ transform: rotate(360deg) translate(42px,-58px) } }
  @keyframes orbit-c { from{ transform: translate(18px,-26px) } to{ transform: rotate(360deg) translate(18px,-26px) } }

  /* Back to top */
  #backToTop{ position: fixed; right: 14px; bottom: 100px; z-index: 20; display:none }
</style>
</head>
<body class="selection:bg-purple/30">

<!-- Floating FAB -->
<button id="hamburgerFab" aria-controls="sideMenu" aria-expanded="false" aria-label="Open menu" title="Menu">
  <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#00d9ff" stroke-width="2">
    <path d="M9 18V5l10-2v13" />
    <circle cx="7" cy="18" r="3" />
    <circle cx="17" cy="16" r="3" />
  </svg>
</button>
<div id="menuBackdrop"></div>

<!-- Slide-in Menu -->
<nav id="sideMenu" aria-hidden="true">
  <details class="menu-group" open><summary>Home</summary>
    <a href="index.html">Dashboard</a>
    <a href="#ads-info">How Ads Work</a>
    <a href="#donate">Donate</a>
    <a href="#killa-bees">Killa Bees</a>
  </details>
  <details class="menu-group"><summary>Studio & AI</summary>
    <a href="studio-tools.html">All Tools</a>
    <a href="lyrics-ai.html">AI Lyrics</a>
    <a href="song-ai.html">AI Song</a>
    <a href="album-ai.html">AI Album</a>
    <a href="voice-ai.html">Voice / Post VO</a>
    <a href="master_ai.html">Master AI</a>
    <a href="cover_ai.html">Cover AI</a>
  </details>
  <details class="menu-group"><summary>Tournaments</summary>
    <a href="game-tournaments.html">Overview</a>
    <a href="game-leaderboards.html">Leaderboards</a>
    <a href="games.html">Games</a>
    <a href="arcade.html">Arcade</a>
  </details>
  <details class="menu-group"><summary>Community</summary>
    <a href="feed.html">Feed</a>
    <a href="profiles.html">Profiles</a>
    <a href="featured.html">Featured</a>
    <a href="blog.html">Blog</a>
    <a href="radio.html">Radio</a>
    <a href="podcast.html">Podcast</a>
  </details>
  <details class="menu-group"><summary>Shop</summary>
    <a href="shop.html">Store</a>
    <a href="coinshop.html">Coin Shop</a>
    <a href="upgrades.html">Upgrades</a>
    <a href="stickers.html">Stickers</a>
    <a href="shop-stickers.html">Shop Stickers</a>
    <a href="shop-upgrades.html">Shop Upgrades</a>
  </details>
  <details class="menu-group"><summary>Help & Legal</summary>
    <a href="faq.html">FAQ</a>
    <a href="contact.html">Contact</a>
    <a href="privacy.html">Privacy</a>
    <a href="terms.html">Terms</a>
  </details>
</nav>

<!-- Carrie -->
<div id="carrieWrap" title="Chat with Carrie (drag, double-tap to change mode)">
  <img id="carrie"
       src="assets/images/carrie_casual.png"
       alt="Carrie"
       onerror="this.onerror=null;this.src='assets/images/default_user_32_40.png'">
</div>

<!-- Header -->
<header class="max-w-6xl mx-auto px-4 pt-6 pb-3">
  <div class="flex items-end justify-between gap-3">
    <div class="flex items-center gap-3">
      <img src="assets/images/logo_8bfr.svg" alt="8BFR logo" class="h-10 w-auto"
           onerror="this.onerror=null;this.src='assets/images/logo_8bfr.png'">
      <div>
        <h1 class="text-2xl sm:text-3xl font-extrabold">8BFR <span class="text-neon">Music</span> Network</h1>
        <p class="text-xs sm:text-sm text-purple/80 -mt-1">Create ‚Ä¢ Connect ‚Ä¢ Collab</p>
      </div>
    </div>
    <a href="mailto:8bfr.music@gmail.com" class="text-neon underline/50 hover:underline">Contact</a>
  </div>
  <div class="marquee mt-4 rounded-xl border border-purple/40 bg-black/30">
    <span class="py-2 px-3">
      <a href="#ads-info" class="hover:underline">
        üéÆ Tournaments ‚Ä¢ üéµ Studio & AI Tools ‚Ä¢ üéôÔ∏è Influencer AI ‚Ä¢ ‚úçÔ∏è Author AI ‚Ä¢ üîÑ Stream Mirroring ‚Ä¢ üõí Seller Tools ‚Ä¢ ü§ñ Carrie AI ‚Ä¢ üîé Explore everything.
      </a>
    </span>
  </div>
</header>

<!-- HERO -->
<section class="max-w-6xl mx-auto px-4 mt-5" aria-label="Site highlights">
  <div class="hero"><div id="hero-text"><h2 id="hero-line" class="text-2xl sm:text-3xl">Loading‚Ä¶</h2></div></div>
</section>

<!-- ADS -->
<section class="max-w-6xl mx-auto px-4 mt-6">
  <div class="ad-frame">
    <div id="adTrack" class="ad-track"></div>
    <button id="adPrev" aria-label="Previous" class="ad-btn">‚Äπ</button>
    <button id="adNext" aria-label="Next" class="ad-btn">‚Ä∫</button>
    <button id="adPause" class="ad-btn" style="top:auto;bottom:10px">Pause</button>
  </div>
  <div class="mt-3 flex items-center gap-2">
    <a href="ads.html#form" class="btn">Buy an Ad</a>
    <a href="#ads-info" class="text-sm underline/50 hover:underline">How ads work</a>
  </div>
</section>

<!-- HOW ADS WORK -->
<section id="ads-info" class="max-w-6xl mx-auto px-4 mt-8 section-card p-5">
  <h3 class="text-xl font-bold mb-2">How Ads Work</h3>
  <p class="text-sm opacity-85 mb-4">There are always 5 ad slots in rotation. When someone buys an ad, it replaces a placeholder until it expires‚Äîthen the placeholder returns. Click any ad to open it. You can pause and use arrows to navigate.</p>
  <a href="ads.html#form" class="btn">Buy an Ad</a>
</section>

<!-- DONATE -->
<section id="donate" class="max-w-6xl mx-auto px-4 mt-6 section-card p-5">
  <h3 class="text-xl font-bold mb-2">Support 8BFR</h3>
  <p class="text-sm opacity-85 mb-4">Help us empower creators and keep the lights neon üíú</p>
  <a class="btn" href="https://www.paypal.com/donate?business=8bfr.music@gmail.com" target="_blank" rel="noopener">Donate via PayPal</a>
</section>

<!-- KILLA BEES + SPOTIFY -->
<section id="killa-bees" class="max-w-6xl mx-auto px-4 mt-6 section-card p-5">
  <h3 class="text-xl font-bold mb-2">Killa Bees ‚Äî Featured Track</h3>
  <div class="w-full max-w-3xl">
    <iframe style="border-radius:12px"
      src="https://open.spotify.com/embed/artist/127tw52iDXr7BvgB0IGG2x?utm_source=generator&theme=0"
      width="100%" height="152" frameborder="0" allowfullscreen=""
      allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
  </div>
  <audio controls autoplay style="width:100%;max-width:600px" class="mt-3">
    <source src="assets/audio/killa_bees.mp3" type="audio/mpeg">Your browser does not support the audio element.
  </audio>
  <div class="mt-3">
    <a href="https://open.spotify.com/artist/127tw52iDXr7BvgB0IGG2x" target="_blank" rel="noopener" class="btn">Open 8BFR on Spotify</a>
  </div>
</section>

<!-- FEATURED ARTISTS -->
<section class="max-w-6xl mx-auto px-4 mt-6 section-card p-5">
  <h3 class="text-xl font-bold mb-4">Featured Artists</h3>
  <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
    <a href="profile_artist.html" class="block rounded-lg border border-purple/30 bg-black/30 p-4 hover:bg-black/40">
      <img src="assets/images/default_user_32_40.png" class="w-full h-40 object-cover rounded-md mb-2" alt="">
      <div class="font-semibold">8BFR</div>
      <div class="text-sm text-purple/70">Hip-hop ‚Ä¢ Producer</div>
    </a>
    <a href="profile_artist.html" class="block rounded-lg border border-purple/30 bg-black/30 p-4 hover:bg-black/40">
      <img src="assets/images/default_user_35_40_girl.png" class="w-full h-40 object-cover rounded-md mb-2" alt="">
      <div class="font-semibold">Nova Rae</div>
      <div class="text-sm text-purple/70">R&B ‚Ä¢ Soul</div>
    </a>
    <a href="profile_artist.html" class="block rounded-lg border border-purple/30 bg-black/30 p-4 hover:bg-black/40">
      <img src="assets/images/default_user_41_+.png" class="w-full h-40 object-cover rounded-md mb-2" alt="">
      <div class="font-semibold">K. Drip</div>
      <div class="text-sm text-purple/70">Trap ‚Ä¢ Beats</div>
    </a>
  </div>
</section>

<!-- FEATURED SONGS -->
<section class="max-w-6xl mx-auto px-4 mt-6 section-card p-5">
  <h3 class="text-xl font-bold mb-4">Featured Songs</h3>
  <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
    <a href="song.html" class="block rounded-lg border border-purple/30 bg-black/30 p-4 hover:bg-black/40">
      <img src="assets/images/default_post.jpg" class="w-full h-40 object-cover rounded-md mb-2" alt="">
      <div class="font-semibold">Killa Bees</div>
      <div class="text-sm text-purple/70">8BFR ‚Ä¢ 3:33</div>
    </a>
    <a href="song.html" class="block rounded-lg border border-purple/30 bg-black/30 p-4 hover:bg-black/40">
      <img src="assets/images/default_post.jpg" class="w-full h-40 object-cover rounded-md mb-2" alt="">
      <div class="font-semibold">Night Drive</div>
      <div class="text-sm text-purple/70">Nova Rae ‚Ä¢ 2:58</div>
    </a>
    <a href="song.html" class="block rounded-lg border border-purple/30 bg-black/30 p-4 hover:bg-black/40">
      <img src="assets/images/default_post.jpg" class="w-full h-40 object-cover rounded-md mb-2" alt="">
      <div class="font-semibold">Vapor Loop</div>
      <div class="text-sm text-purple/70">K. Drip ‚Ä¢ 4:01</div>
    </a>
  </div>
</section>

<!-- COMMUNITY FEED PREVIEW -->
<section class="max-w-6xl mx-auto px-4 mt-6 section-card p-5">
  <h3 class="text-xl font-bold mb-3">Community Feed</h3>
  <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
    <div class="rounded-lg border border-purple/30 bg-black/30 p-3"><div class="text-sm opacity-80">@user ‚Ä¢ 2m</div><div>Just dropped a new beat! üî•</div></div>
    <div class="rounded-lg border border-purple/30 bg-black/30 p-3"><div class="text-sm opacity-80">@dj ‚Ä¢ 9m</div><div>Live on radio in 10!</div></div>
    <div class="rounded-lg border border-purple/30 bg-black/30 p-3"><div class="text-sm opacity-80">@singer ‚Ä¢ 15m</div><div>Studio session tonight üé§</div></div>
  </div>
  <a href="feed.html" class="btn mt-3 inline-block">Open Feed</a>
</section>

<!-- RADIO PREVIEW -->
<section class="max-w-6xl mx-auto px-4 mt-6 section-card p-5">
  <h3 class="text-xl font-bold mb-2">8BFR Radio</h3>
  <p class="text-sm opacity-85 mb-3">Community picks & live sets.</p>
  <div class="w-full max-w-3xl">
    <audio controls style="width:100%"><source src="assets/audio/radio_preview.mp3" type="audio/mpeg"></audio>
  </div>
  <a href="radio.html" class="btn mt-3 inline-block">Open Radio</a>
</section>

<!-- FOOTER -->
<footer class="mt-12 pb-28 sm:pb-16 border-t border-purple/30 pt-8 bg-black/30">
  <div class="max-w-6xl mx-auto px-4 grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
    <div>
      <div class="font-bold mb-2">8BFR</div>
      <a class="block opacity-85 hover:underline" href="index.html">Home</a>
      <a class="block opacity-85 hover:underline" href="about.html">About</a>
      <a class="block opacity-85 hover:underline" href="contact.html">Contact</a>
    </div>
    <div>
      <div class="font-bold mb-2">Studio & AI</div>
      <a class="block opacity-85 hover:underline" href="studio-tools.html">All Tools</a>
      <a class="block opacity-85 hover:underline" href="lyrics-ai.html">AI Lyrics</a>
      <a class="block opacity-85 hover:underline" href="song-ai.html">AI Song</a>
      <a class="block opacity-85 hover:underline" href="album-ai.html">AI Album</a>
    </div>
    <div>
      <div class="font-bold mb-2">Community</div>
      <a class="block opacity-85 hover:underline" href="feed.html">Feed</a>
      <a class="block opacity-85 hover:underline" href="profiles.html">Profiles</a>
      <a class="block opacity-85 hover:underline" href="featured.html">Featured</a>
    </div>
    <div>
      <div class="font-bold mb-2">Legal</div>
      <a class="block opacity-85 hover:underline" href="privacy.html">Privacy</a>
      <a class="block opacity-85 hover:underline" href="terms.html">Terms</a>
    </div>
  </div>
  <div class="max-w-6xl mx-auto px-4 mt-6 text-center text-xs text-purple/70">
    ¬© 2025 8BFR Music Network ‚Äî ‚ÄúEmpowering creators, connecting the world ‚Äî 8BFR Music Network.‚Äù
  </div>
</footer>

<a id="backToTop" href="#top" class="btn">Back to top</a>

<!-- ===== SCRIPTS ===== -->
<script>
/* HERO lines */
(function(){
  const lines = [
    "Game Tournaments (Win Free Coins)",
    "Music Studio ‚Äî AI Lyrics Generator & AI Beat Creator (Artists & Beatmakers)",
    "AI Post Creator with Voiceover (Influencers)",
    "AI Helper for Authors",
    "Mirror Your Streams from Other Sites",
    "Seller Options in Shop ‚Äî Group 7 (G7) Perks",
    "Carrie ‚Äî AI Chat & Helper",
    "Explore the site to find all features"
  ];
  const el = document.getElementById('hero-line'); if(!el) return;
  let i=0; const show=()=>{el.classList.add('hide'); setTimeout(()=>{i=(i+1)%lines.length; el.textContent=lines[i]; el.classList.remove('hide');},250);};
  el.textContent = lines[0]; setInterval(show, 5000);
})();

/* Ad carousel (single-at-a-time) */
(function(){
  const ads = [
    {img:'assets/images/ad_banner_1.jpg', url:'#'},
    {img:'assets/images/ad_banner_2.jpg', url:'#'},
    {img:'assets/images/ad_banner_3.jpg', url:'#'},
    {img:'assets/images/ad_banner_4.jpg', url:'#'},
    {img:'assets/images/ad_banner_5.jpg', url:'#'}
  ];
  const track = document.getElementById('adTrack');
  const prev = document.getElementById('adPrev');
  const next = document.getElementById('adNext');
  const pause = document.getElementById('adPause');
  let i=0, paused=false, t=null;

  function make(idx){
    const a = document.createElement('a');
    a.className='ad-slide'; a.href = ads[idx].url || '#'; a.target='_blank'; a.rel='noopener';
    const img = new Image(); img.src = ads[idx].img; img.alt='Ad';
    a.appendChild(img); return a;
  }
  function show(idx){
    i = (idx+ads.length)%ads.length;
    const old = track.querySelector('.ad-slide.show');
    const neu = make(i); track.appendChild(neu);
    requestAnimationFrame(()=>{ neu.classList.add('show'); });
    if(old){ setTimeout(()=> old.remove(), 380); }
  }
  function auto(){ if(paused) return; show(i+1); schedule(); }
  function schedule(){ clearTimeout(t); t = setTimeout(auto, 5000); }

  prev.onclick = ()=>{ if(!paused){ paused=true; pause.textContent='Play'; } show(i-1); };
  next.onclick = ()=>{ if(!paused){ paused=true; pause.textContent='Play'; } show(i+1); };
  pause.onclick = ()=>{ paused=!paused; pause.textContent = paused ? 'Play' : 'Pause'; if(!paused) schedule(); else clearTimeout(t); };

  show(0); schedule();
})();

/* Floating menu controls (auto-close) */
(function(){
  const fab = document.getElementById('hamburgerFab');
  const menu = document.getElementById('sideMenu');
  const backdrop = document.getElementById('menuBackdrop');
  const carrieWrap = document.getElementById('carrieWrap');
  let timer = null;
  function openMenu(){ menu.classList.add('open'); backdrop.classList.add('open'); fab.setAttribute('aria-expanded','true'); carrieWrap.classList.add('aside'); resetTimer(); }
  function closeMenu(){ menu.classList.remove('open'); backdrop.classList.remove('open'); fab.setAttribute('aria-expanded','false'); carrieWrap.classList.remove('aside'); clearTimeout(timer); timer=null; }
  function resetTimer(){ clearTimeout(timer); timer = setTimeout(closeMenu, 20000); }
  fab.addEventListener('click', (e)=>{ e.stopPropagation(); menu.classList.contains('open')?closeMenu():openMenu(); });
  backdrop.addEventListener('click', closeMenu);
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeMenu(); });
  menu.addEventListener('pointermove', resetTimer);
  menu.addEventListener('wheel', resetTimer);
})();

/* Carrie behaviors: hover swap, draggable, fun modes (bob/dance/pace/juggle) */
(function(){
  const wrap = document.getElementById('carrieWrap');
  const img  = document.getElementById('carrie');
  img.classList.add('carrie--bob');

  // hover: switch to business if present
  img.addEventListener('mouseenter', ()=> {
    const t = new Image();
    t.onload = ()=>{ img.dataset.src = img.src; img.src = 'assets/images/carrie_business.png'; };
    t.src = 'assets/images/carrie_business.png';
  });
  img.addEventListener('mouseleave', ()=> {
    if(img.dataset.src){ img.src = img.dataset.src; delete img.dataset.src; }
  });

  // click -> chat
  img.addEventListener('click', ()=> location.href = 'carrie-chat.html');

  // draggable
  let dragging=false, sx=0, sy=0, ox=0, oy=0;
  const getXY = (e)=>('touches' in e)?[e.touches[0].clientX,e.touches[0].clientY]:[e.clientX,e.clientY];
  const onDown = (e)=>{ dragging=true; [sx,sy]=getXY(e); const r=wrap.getBoundingClientRect(); ox=r.left; oy=r.top; e.preventDefault(); }
  const onMove = (e)=>{ if(!dragging) return; const [x,y]=getXY(e); const dx=x-sx, dy=y-sy; wrap.style.right='auto'; wrap.style.bottom='auto'; wrap.style.left=(ox+dx)+'px'; wrap.style.top=(oy+dy)+'px'; }
  const onUp = ()=> dragging=false;
  wrap.addEventListener('mousedown', onDown); wrap.addEventListener('touchstart', onDown, {passive:false});
  window.addEventListener('mousemove', onMove, {passive:false}); window.addEventListener('touchmove', onMove, {passive:false});
  window.addEventListener('mouseup', onUp); window.addEventListener('touchend', onUp);

  // Modes
  let mode = 'bob';
  function setMode(next){
    img.classList.remove('carrie--bob','carrie--dance','carrie--pace','carrie--wave');
    const j = wrap.querySelector('.carrie-juggle'); if(j) j.remove();
    mode = next;
    if(mode==='bob'){ img.classList.add('carrie--bob'); }
    if(mode==='dance'){ img.classList.add('carrie--dance'); }
    if(mode==='pace'){ img.classList.add('carrie--pace'); }
    if(mode==='juggle'){
      img.classList.add('carrie--bob');
      const layer = document.createElement('div'); layer.className = 'carrie-juggle';
      const mk = (c)=>{ const d=document.createElement('div'); d.className='carrie-coin '+c; return d; };
      layer.append(mk('carrie-coin--a'), mk('carrie-coin--b'), mk('carrie-coin--c'));
      wrap.append(layer);
    }
  }
  const order = ['bob','dance','pace','juggle']; let idx=0;
  function cycle(){
    idx = (idx+1) % order.length;
    img.classList.add('carrie--wave'); setTimeout(()=> img.classList.remove('carrie--wave'), 1200);
    setMode(order[idx]);
  }
  setMode(order[0]);
  setInterval(cycle, 12000);
  wrap.addEventListener('dblclick', (e)=>{ e.preventDefault(); cycle(); });
})();

/* Back to top show/hide */
(function(){
  const btn = document.getElementById('backToTop');
  const onScroll = ()=>{ btn.style.display = window.scrollY > 600 ? 'block' : 'none'; };
  window.addEventListener('scroll', onScroll); onScroll();
})();
</script>
</body>
</html>
