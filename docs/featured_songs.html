<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Featured Songs ‚Äî 8BFR Music Network</title>
<link rel="icon" href="assets/images/favicon.png" />
<script src="https://cdn.tailwindcss.com"></script>
<style>
  * { box-sizing: border-box; }
  body {
    background: linear-gradient(#0b0014, #000);
    color: #eae6ff;
    font-family: system-ui, -apple-system, sans-serif;
    margin: 0;
    padding: 0;
  }
  
  .header {
    background: rgba(15, 0, 30, 0.95);
    border-bottom: 1px solid rgba(124, 58, 237, 0.5);
    position: sticky;
    top: 0;
    z-index: 100;
    backdrop-filter: blur(12px);
  }
  
  .featured-badge {
    display: inline-block;
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: white;
    padding: 0.4rem 1rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 700;
    margin-bottom: 1rem;
  }
  
  .song-card {
    background: rgba(12, 6, 24, 0.8);
    border: 1px solid rgba(124, 58, 237, 0.35);
    border-radius: 16px;
    padding: 1.5rem;
    transition: all 0.3s;
    display: flex;
    gap: 1rem;
    align-items: center;
  }
  
  .song-card:hover {
    border-color: rgba(168, 85, 247, 0.6);
    box-shadow: 0 8px 32px rgba(124, 58, 237, 0.3);
  }
  
  .song-icon {
    width: 60px;
    height: 60px;
    border-radius: 12px;
    background: linear-gradient(135deg, #7c3aed, #a855f7);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    flex-shrink: 0;
    box-shadow: 0 4px 20px rgba(124, 58, 237, 0.4);
  }
  
  .song-info {
    flex: 1;
    min-width: 0;
  }
  
  .song-title {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 0.3rem;
  }
  
  .song-artist {
    font-size: 0.9rem;
    color: #a855f7;
    opacity: 0.8;
    display: flex;
    align-items: center;
    gap: 0.4rem;
  }
  
  .verified-badge {
    color: #00d9ff;
    font-size: 0.9rem;
  }
  
  .play-btn {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, #7c3aed, #a855f7);
    border: none;
    color: white;
    font-size: 1.3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s;
    flex-shrink: 0;
  }
  
  .play-btn:hover {
    box-shadow: 0 4px 20px rgba(124, 58, 237, 0.6);
    transform: scale(1.05);
  }
  
  /* ADMIN CONTROLS */
  .admin-controls {
    display: none;
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid rgba(124, 58, 237, 0.2);
    gap: 0.5rem;
  }
  
  .admin-btn {
    flex: 1;
    padding: 0.6rem;
    border: 1px solid;
    border-radius: 8px;
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .remove-btn {
    background: rgba(239, 68, 68, 0.2);
    border-color: rgba(239, 68, 68, 0.5);
    color: #ef4444;
  }
  
  .remove-btn:hover {
    background: rgba(239, 68, 68, 0.4);
  }
  
  @media (max-width: 640px) {
    .song-card {
      flex-direction: column;
      text-align: center;
    }
    
    .song-info {
      text-align: center;
    }
  }
</style>
</head>
<body>

<header class="header">
  <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
    <a href="index.html" style="color: #a855f7; text-decoration: none; font-weight: 600;">‚Üê Home</a>
    <h1 style="font-size: 1.25rem; font-weight: 800; background: linear-gradient(135deg, #f59e0b, #d97706); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
      üéµ Featured Songs
    </h1>
    <div style="width: 80px;"></div>
  </div>
</header>

<main class="max-w-4xl mx-auto px-4 py-6">
  
  <div style="text-align: center; margin-bottom: 2rem;">
    <div class="featured-badge">‚ú® HAND-PICKED BY 8BFR</div>
    <p style="color: #a855f7; opacity: 0.8; font-size: 0.95rem;">
      Top tracks selected by our team
    </p>
  </div>
  
  <div id="featuredSongs" style="display: flex; flex-direction: column; gap: 1rem;">
    <!-- Songs load here -->
  </div>
  
  <div id="emptyState" style="display: none; text-align: center; padding: 4rem 2rem; color: #a855f7; opacity: 0.7;">
    <div style="font-size: 4rem; margin-bottom: 1rem;">üéµ</div>
    <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 0.5rem;">No featured songs yet</div>
    <div style="font-size: 0.9rem;">Check back soon for hand-picked tracks!</div>
  </div>
  
</main>

<script src="scripts.js?v=6" defer></script>

<script>
// ===== ADMIN SYSTEM =====
function isAdmin() {
  const role = localStorage.getItem('userRole');
  return role === 'owner' || role === 'admin' || role === 'mod';
}

function logAdminAction(action, targetId, targetType) {
  const logs = JSON.parse(localStorage.getItem('admin_activity_log') || '[]');
  
  logs.push({
    action: action,
    targetId: targetId,
    targetType: targetType,
    performedBy: localStorage.getItem('username') || 'Admin',
    role: localStorage.getItem('userRole'),
    timestamp: Date.now()
  });
  
  if (logs.length > 1000) logs.shift();
  
  localStorage.setItem('admin_activity_log', JSON.stringify(logs));
  
  // Notify owner
  const notifications = JSON.parse(localStorage.getItem('owner_notifications') || '[]');
  notifications.push({
    type: 'admin_action',
    action: action,
    targetId: targetId,
    targetType: targetType,
    performedBy: localStorage.getItem('username'),
    timestamp: Date.now(),
    read: false
  });
  localStorage.setItem('owner_notifications', JSON.stringify(notifications));
}

function removeFeatured(trackKey) {
  if (!confirm('Remove this song from featured?')) return;
  
  const featured = JSON.parse(localStorage.getItem('featured_items') || '{}');
  if (!featured.songs) featured.songs = [];
  
  featured.songs = featured.songs.filter(key => key !== trackKey);
  localStorage.setItem('featured_items', JSON.stringify(featured));
  
  logAdminAction('featured_remove', trackKey, 'song');
  
  alert('‚ùå Removed from featured');
  location.reload();
}

function playSong(url) {
  if (url.includes('spotify.com') || url.includes('apple.com')) {
    window.open(url, '_blank');
  } else {
    alert('üéµ Playing: ' + url);
    // Add actual player logic here
  }
}

// ===== LOAD FEATURED SONGS =====
function loadFeaturedSongs() {
  const featured = JSON.parse(localStorage.getItem('featured_items') || '{}');
  const featuredSongs = featured.songs || [];
  
  if (featuredSongs.length === 0) {
    document.getElementById('featuredSongs').style.display = 'none';
    document.getElementById('emptyState').style.display = 'block';
    return;
  }
  
  // Parse track keys (format: "profileKey::trackIndex")
  const songsHTML = featuredSongs.map(trackKey => {
    const [profileKey, trackIndex] = trackKey.split('::');
    const profile = JSON.parse(localStorage.getItem(profileKey) || '{}');
    
    if (!profile.name || !profile.tracks) return '';
    
    const track = profile.tracks[parseInt(trackIndex)];
    if (!track) return '';
    
    const artistId = profileKey.replace('profile_', '');
    
    // Get badge emoji
    let badgeEmoji = 'üéµ';
    if (profile.badges) {
      if (profile.badges.includes('artist')) badgeEmoji = 'üé§';
      else if (profile.badges.includes('beatmaker')) badgeEmoji = 'üéöÔ∏è';
    }
    
    return `
      <div class="song-card">
        <div class="song-icon">${badgeEmoji}</div>
        
        <div class="song-info">
          <div class="song-title">${track.title || 'Untitled Track'}</div>
          <div class="song-artist">
            <a href="profile.html?id=${artistId}" style="color: inherit; text-decoration: none;">
              ${profile.name}
            </a>
            ${profile.verified ? '<span class="verified-badge">‚úì</span>' : ''}
          </div>
          
          <!-- ADMIN CONTROLS -->
          <div class="admin-controls" data-admin-controls style="display: none;">
            <button class="admin-btn remove-btn" onclick="removeFeatured('${trackKey}')">
              ‚ùå Remove Featured
            </button>
          </div>
        </div>
        
        <button class="play-btn" onclick="playSong('${track.url}')">‚ñ∂Ô∏è</button>
      </div>
    `;
  }).filter(html => html).join('');
  
  if (!songsHTML) {
    document.getElementById('featuredSongs').style.display = 'none';
    document.getElementById('emptyState').style.display = 'block';
    return;
  }
  
  document.getElementById('featuredSongs').innerHTML = songsHTML;
  
  // Show admin controls if admin
  if (isAdmin()) {
    document.querySelectorAll('[data-admin-controls]').forEach(el => {
      el.style.display = 'flex';
    });
  }
}

// ===== INIT =====
loadFeaturedSongs();

// ===== HIDE BUBBLES =====
window.addEventListener("load", function(){
  setTimeout(function(){
    const idsToHide = ['bubbleStack', 'bubble-top-single', 'carrieWrap', 'carrieBubble', 'carrieToggleBar'];
    idsToHide.forEach(id => {
      const el = document.getElementById(id);
      if (el) el.style.display = 'none';
    });
    
    const classesToHide = ['.bubble-stack', '.floating-bubbles', '.carrie-bubble', '.bubble-container'];
    classesToHide.forEach(cls => {
      document.querySelectorAll(cls).forEach(el => el.style.display = 'none');
    });
    
    document.querySelectorAll('[data-bubble]').forEach(el => el.style.display = 'none');
    document.querySelectorAll('[data-role="carrie"], [data-carrie]').forEach(el => el.style.display = 'none');
  }, 300);
});
</script>

</body>
</html>
