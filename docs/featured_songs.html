<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Featured Songs & Artists â€” 8BFR</title>
<link rel="icon" href="assets/images/favicon.png">
<script src="https://cdn.tailwindcss.com"></script>
<style>
body{background:linear-gradient(#0b0014,#000);color:#eae6ff;font-family:system-ui;margin:0}
.section-card{border:1px solid rgba(124,58,237,.35);background:#0c0618;border-radius:14px;box-shadow:0 0 20px rgba(124,58,237,.18);padding:1.25rem;margin-bottom:1.5rem}
.btn{display:inline-block;background:#120327;border:1px solid rgba(124,58,237,.6);color:#eae6ff;padding:.4rem .7rem;border-radius:.6rem;text-decoration:none;transition:all .2s}
.btn:hover{background:#190536}
.btn-primary{background:linear-gradient(135deg,#7c3aed,#a855f7);border-color:#a855f7}
.btn-primary:hover{background:linear-gradient(135deg,#6d28d9,#9333ea)}
.song-item{background:rgba(15,0,30,0.6);border:1px solid rgba(124,58,237,0.3);border-radius:12px;padding:1rem;margin-bottom:0.75rem;transition:all .2s}
.song-item:hover{background:rgba(124,58,237,0.15);border-color:rgba(124,58,237,0.5)}
.artist-card{background:rgba(15,0,30,0.6);border:1px solid rgba(124,58,237,0.3);border-radius:12px;padding:1.25rem;transition:all .2s}
.artist-card:hover{background:rgba(124,58,237,0.15);border-color:rgba(124,58,237,0.5);transform:translateY(-2px)}
.jump-link{font-size:0.85rem;color:#a855f7;text-decoration:none;display:inline-flex;align-items:center;gap:0.3rem}
.jump-link:hover{color:#c084fc;text-decoration:underline}
</style>
</head>
<body>
<header class="px-4 py-4 bg-[rgba(15,0,30,.9)] border-b border-purple-500/40">
  <div class="max-w-6xl mx-auto flex items-center justify-between">
    <a href="index.html" class="btn">â† Home</a>
    <h1 class="text-lg font-bold">ğŸµ Featured Songs & Artists</h1>
    <span></span>
  </div>
</header>

<main class="max-w-6xl mx-auto px-4 py-6">
  
  <!-- FEATURED SONGS SECTION -->
  <section id="songs" class="section-card">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-2xl font-bold">ğŸµ Featured Songs</h2>
      <a href="#artists" class="jump-link">Jump to Artists â†“</a>
    </div>
    
    <div id="featuredSongsList">
      <div style="text-align:center;padding:3rem 1rem;color:#a855f7;opacity:0.7">
        <div style="font-size:3rem;margin-bottom:1rem">ğŸµ</div>
        <div>Loading featured songs...</div>
      </div>
    </div>
  </section>

  <!-- FEATURED ARTISTS SECTION -->
  <section id="artists" class="section-card">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-2xl font-bold">ğŸ¤ Featured Artists</h2>
      <a href="#songs" class="jump-link">Jump to Songs â†‘</a>
    </div>
    
    <div id="featuredArtistsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <div style="text-align:center;padding:3rem 1rem;color:#a855f7;opacity:0.7;grid-column:1/-1">
        <div style="font-size:3rem;margin-bottom:1rem">ğŸ¤</div>
        <div>Loading featured artists...</div>
      </div>
    </div>
  </section>

</main>

<script src="scripts.js?v=6" defer></script>

<script>
(function() {
  // Get badge emoji
  function getBadgeEmoji(badges) {
    if (!badges || !badges.length) return 'ğŸµ';
    if (badges.includes('artist')) return 'ğŸ¤';
    if (badges.includes('beatmaker')) return 'ğŸšï¸';
    if (badges.includes('producer')) return 'ğŸ§';
    if (badges.includes('singer')) return 'ğŸ™ï¸';
    if (badges.includes('dj')) return 'ğŸ“€';
    return 'ğŸµ';
  }

  // Load featured songs
  function loadFeaturedSongs() {
    const songs = [];
    
    for (let i = 0; i < localStorage.length; i++) {
      const key = localStorage.key(i);
      if (!key.startsWith('profile_')) continue;
      
      try {
        const profile = JSON.parse(localStorage.getItem(key) || '{}');
        
        // Check for creator badge + verified
        const hasCreatorBadge = 
          profile.badges && (
            profile.badges.includes('artist') || 
            profile.badges.includes('beatmaker')
          );
        const isVerified = profile.verified === true;
        
        if (!hasCreatorBadge || !isVerified) continue;
        
        const tracks = profile.tracks || [];
        tracks.forEach(track => {
          if (!track.url) return;
          songs.push({
            title: track.title || 'Untitled',
            url: track.url,
            artist: profile.name || 'Unknown',
            artistId: key.replace('profile_', ''),
            emoji: getBadgeEmoji(profile.badges),
            verified: true
          });
        });
      } catch(e) {}
    }
    
    const container = document.getElementById('featuredSongsList');
    
    if (songs.length === 0) {
      container.innerHTML = `
        <div style="text-align:center;padding:3rem 1rem;color:#a855f7;opacity:0.7">
          <div style="font-size:3rem;margin-bottom:1rem">ğŸµ</div>
          <div style="font-size:1rem;margin-bottom:0.5rem">No featured songs yet</div>
          <div style="font-size:0.85rem">Verified artists can upload tracks to be featured!</div>
        </div>
      `;
      return;
    }
    
    container.innerHTML = songs.map(song => `
      <div class="song-item" style="display:flex;align-items:center;gap:1rem">
        <div style="width:50px;height:50px;border-radius:10px;background:linear-gradient(135deg,#7c3aed,#a855f7);display:flex;align-items:center;justify-content:center;font-size:1.5rem;flex-shrink:0">
          ${song.emoji}
        </div>
        <div style="flex:1;min-width:0">
          <div style="font-weight:700;font-size:1.1rem;margin-bottom:0.25rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">
            ${song.title}
          </div>
          <div style="font-size:0.9rem;color:#a855f7;display:flex;align-items:center;gap:0.4rem">
            <a href="profile.html?id=${song.artistId}" style="text-decoration:none;color:#a855f7">
              ${song.artist}
            </a>
            ${song.verified ? '<span style="color:#00d9ff">ğŸ›¡ï¸</span>' : ''}
          </div>
        </div>
        <a href="${song.url}" target="_blank" class="btn btn-primary" style="flex-shrink:0">
          â–¶ï¸ Play
        </a>
      </div>
    `).join('');
  }

  // Load featured artists
  function loadFeaturedArtists() {
    const artists = [];
    
    for (let i = 0; i < localStorage.length; i++) {
      const key = localStorage.key(i);
      if (!key.startsWith('profile_')) continue;
      
      try {
        const profile = JSON.parse(localStorage.getItem(key) || '{}');
        
        // Check for creator badge + verified
        const hasCreatorBadge = 
          profile.badges && (
            profile.badges.includes('artist') || 
            profile.badges.includes('beatmaker')
          );
        const isVerified = profile.verified === true;
        
        if (!hasCreatorBadge || !isVerified) continue;
        
        const trackCount = (profile.tracks || []).length;
        
        artists.push({
          name: profile.name || 'Unknown',
          id: key.replace('profile_', ''),
          emoji: getBadgeEmoji(profile.badges),
          badge: profile.badges.includes('artist') ? 'Artist' : 'Beatmaker',
          trackCount,
          verified: true
        });
      } catch(e) {}
    }
    
    const container = document.getElementById('featuredArtistsList');
    
    if (artists.length === 0) {
      container.innerHTML = `
        <div style="text-align:center;padding:3rem 1rem;color:#a855f7;opacity:0.7;grid-column:1/-1">
          <div style="font-size:3rem;margin-bottom:1rem">ğŸ¤</div>
          <div style="font-size:1rem;margin-bottom:0.5rem">No featured artists yet</div>
          <div style="font-size:0.85rem">Verified artists will be featured here!</div>
        </div>
      `;
      return;
    }
    
    container.innerHTML = artists.map(artist => `
      <div class="artist-card">
        <div style="display:flex;align-items:center;gap:1rem;margin-bottom:1rem">
          <div style="width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#7c3aed,#a855f7);display:flex;align-items:center;justify-content:center;font-size:2rem;flex-shrink:0">
            ${artist.emoji}
          </div>
          <div style="flex:1;min-width:0">
            <div style="font-weight:700;font-size:1.15rem;margin-bottom:0.25rem;display:flex;align-items:center;gap:0.4rem">
              <span style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${artist.name}</span>
              ${artist.verified ? '<span style="color:#00d9ff">ğŸ›¡ï¸</span>' : ''}
            </div>
            <div style="font-size:0.85rem;color:#a855f7">
              ${artist.badge}
            </div>
          </div>
        </div>
        
        <div style="padding-top:0.75rem;border-top:1px solid rgba(124,58,237,0.3);display:flex;justify-content:space-between;align-items:center">
          <div style="font-size:0.85rem;color:#a855f7">
            ğŸµ ${artist.trackCount} ${artist.trackCount === 1 ? 'Track' : 'Tracks'}
          </div>
          <a href="profile.html?id=${artist.id}" class="btn">
            View Profile
          </a>
        </div>
      </div>
    `).join('');
  }

  // Initialize
  window.addEventListener('load', () => {
    loadFeaturedSongs();
    loadFeaturedArtists();
  });
})();
</script>

</body>
</html>
