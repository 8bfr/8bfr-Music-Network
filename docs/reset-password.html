<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reset password — 8BFR Music Network</title>
  <meta name="description" content="Reset your 8BFR password." />
  <link rel="icon" href="assets/images/favicon.png" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root{
      --ring: rgba(124,58,237,.65);
      --glass: rgba(12,6,24,.88);
    }
    html,body{ scroll-behavior:smooth; }
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(124,58,237,.35), transparent 60%),
        radial-gradient(900px 400px at 110% 10%, rgba(0,217,255,.22), transparent 60%),
        linear-gradient(#0b0014,#000);
      color:#eae6ff;
      margin:0;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      align-items:center;
    }
    header{
      position:relative;
      z-index:5;
      background:rgba(15,0,30,.9);
      border-bottom:1px solid rgba(124,58,237,.5);
      width:100%;
    }
    .section-card{
      border:1px solid rgba(124,58,237,.35);
      background:#0c0618;
      border-radius:16px;
      box-shadow:0 0 24px rgba(124,58,237,.25);
    }
    .btn{
      display:inline-flex;
      justify-content:center;
      align-items:center;
      gap:.4rem;
      background:#120327;
      border:1px solid rgba(124,58,237,.6);
      color:#eae6ff;
      padding:.6rem .95rem;
      border-radius:.75rem;
      text-decoration:none;
      font-size:.9rem;
      cursor:pointer;
    }
    .btn-primary{
      background:#7c3aed;
      border-color:#7c3aed;
      color:#fff;
    }
    .error-text{
      font-size:.9rem;
      color:#fecaca;
    }
    .success-text{
      font-size:.9rem;
      color:#bbf7d0;
    }
    main{ width:100%; padding:2rem 1rem; display:flex; justify-content:center; }
    .card-inner{ max-width:520px; width:100%; padding:20px; }
    input[type="email"], button[type="submit"]{
      width:100%;
      border-radius:10px;
      padding:10px 12px;
      border:1px solid rgba(124,58,237,.25);
      background:rgba(0,0,0,.45);
      color:inherit;
      outline:none;
    }
    button[type="submit"]{ margin-top:12px; cursor:pointer; }
    footer{
      border-top:1px solid rgba(124,58,237,.35);
      background:#050013cc;
      margin-top:auto;
      width:100%;
      padding:10px 0;
      text-align:center;
      font-size:11px;
      color:rgba(221,214,255,.7);
    }
  </style>
</head>
<body data-no-global-carrie="true">
  <header class="px-4 py-4">
    <div class="max-w-4xl mx-auto flex items-end justify-between gap-3">
      <div class="flex items-center gap-3">
        <img src="assets/images/logo_8bfr.svg" alt="8BFR logo" class="h-10 w-auto"
             onerror="this.onerror=null;this.src='assets/images/8bfr.png'">
        <div>
          <h1 class="text-2xl font-extrabold">8BFR <span style="color:#00d9ff">Music</span> Network</h1>
          <p style="font-size:10px;color:#9ee6b0;font-family:monospace;margin-top:-6px">RESET PASSWORD</p>
        </div>
      </div>
      <a href="index.html" class="text-[#00d9ff] underline/50 hover:underline" style="position:relative;z-index:6">← Back home</a>
    </div>
  </header>

  <main>
    <div class="section-card card-inner">
      <h2 style="font-size:1.125rem;margin:0 0 8px 0">Reset your password</h2>
      <p style="margin:0 0 12px 0;color:#d7cfff">Enter the email you used to sign up. We’ll send a reset link that takes you to a secure page where you can choose a new password.</p>

      <form id="resetForm" novalidate>
        <label for="email" style="display:block;margin-top:8px;color:#ddd;font-size:0.9rem">Email</label>
        <input id="email" type="email" autocomplete="email" required placeholder="you@example.com" />
        <button id="sendBtn" type="submit" class="btn btn-primary" style="margin-top:12px">Send reset email</button>
        <p id="msg" class="error-text" aria-live="polite" style="margin-top:10px;display:none"></p>
        <p id="ok" class="success-text" style="margin-top:10px;display:none"></p>
      </form>

      <div style="margin-top:14px;font-size:0.9rem;color:#cfc0ff">
        <button class="btn" onclick="window.location.href='signup.html'">Need an account? Sign up</button>
      </div>
    </div>
  </main>

  <footer>© 2025 8BFR Music Network — “Empowering creators, connecting the world.”</footer>

  <script>
    (function(){
      const SUPABASE_URL = "https://novbuvwpjnxwwvdekjhr.supabase.co";
      const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5vdmJ1dndwam54d3d2ZGVramhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjExODkxODUsImV4cCI6MjA3Njc2NTE4NX0.1UUkdGafh6ZplAX8hi7Bvj94D2gvFQZUl0an1RvcSA0";

      if (!window.supabase || !window.supabase.createClient) {
        const msgEl = document.getElementById('msg');
        msgEl.style.display = 'block';
        msgEl.textContent = 'Login system unavailable. Please try again later.';
        return;
      }

      const { createClient } = supabase;
      const client = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

      const form = document.getElementById('resetForm');
      const emailEl = document.getElementById('email');
      const msg = document.getElementById('msg');
      const ok = document.getElementById('ok');
      const sendBtn = document.getElementById('sendBtn');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        msg.style.display = 'none';
        ok.style.display = 'none';
        const email = (emailEl.value || '').trim();
        if (!email) { msg.style.display='block'; msg.textContent = 'Please enter your email.'; return; }

        sendBtn.disabled = true;
        sendBtn.textContent = 'Sending…';

        try {
          // Redirect back to change-password.html on the same origin
          const redirectTo = window.location.origin + '/change-password.html';
          const { error } = await client.auth.resetPasswordForEmail(email, { redirectTo });
          if (error) {
            msg.style.display='block';
            msg.textContent = error.message || 'Unable to send reset email.';
          } else {
            ok.style.display='block';
            ok.textContent = 'If that email is registered you will receive a reset link shortly.';
          }
        } catch (err) {
          console.error(err);
          msg.style.display='block';
          msg.textContent = 'Unexpected error — try again later.';
        } finally {
          sendBtn.disabled = false;
          sendBtn.textContent = 'Send reset email';
        }
      });
    })();
  </script>
</body>
</html>
