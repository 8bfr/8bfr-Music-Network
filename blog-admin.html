<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Blog Admin â€” 8BFR</title>
<link rel="icon" href="assets/images/favicon.png">
<script src="https://cdn.tailwindcss.com"></script>
<style>
body {
  background: linear-gradient(#0b0014, #000);
  color: #eae6ff;
  font-family: system-ui, -apple-system, sans-serif;
  margin: 0;
  padding: 0;
  min-height: 100vh;
  padding-bottom: 70px;
}

.card {
  border: 1px solid rgba(124, 58, 237, 0.4);
  background: rgba(12, 6, 24, 0.8);
  border-radius: 16px;
  box-shadow: 0 0 24px rgba(124, 58, 237, 0.2);
  padding: 2rem;
  margin-bottom: 2rem;
}

.input, .textarea, .select {
  width: 100%;
  padding: 0.75rem;
  background: rgba(18, 3, 39, 0.8);
  border: 1px solid rgba(124, 58, 237, 0.6);
  border-radius: 0.75rem;
  color: #fff;
  font-size: 1rem;
  font-family: inherit;
}

.input:focus, .textarea:focus, .select:focus {
  outline: none;
  border-color: #a855f7;
  box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.2);
}

.textarea {
  resize: vertical;
  min-height: 200px;
  font-family: monospace;
  line-height: 1.6;
}

label {
  font-size: 0.9rem;
  font-weight: 600;
  opacity: 0.9;
  display: block;
  margin-bottom: 0.5rem;
  color: #a855f7;
}

.btn {
  display: inline-block;
  background: #7c3aed;
  border: 1px solid #7c3aed;
  color: #fff;
  padding: 0.75rem 1.5rem;
  border-radius: 0.75rem;
  text-decoration: none;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}

.btn:hover {
  background: #6d28d9;
  transform: translateY(-1px);
}

.btn-secondary {
  background: transparent;
  color: #a855f7;
  border: 1px solid rgba(124, 58, 237, 0.6);
}

.btn-secondary:hover {
  background: rgba(124, 58, 237, 0.2);
}

.btn-danger {
  background: #dc2626;
  border-color: #dc2626;
}

.btn-danger:hover {
  background: #b91c1c;
}

.post-item {
  padding: 1rem;
  background: rgba(124, 58, 237, 0.05);
  border: 1px solid rgba(124, 58, 237, 0.2);
  border-radius: 12px;
  margin-bottom: 0.75rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
}

.post-item:hover {
  background: rgba(124, 58, 237, 0.1);
  border-color: rgba(124, 58, 237, 0.4);
}

.checkbox {
  width: auto;
  margin-right: 0.5rem;
}

.form-group {
  margin-bottom: 1.5rem;
}

.help-text {
  font-size: 0.85rem;
  opacity: 0.7;
  margin-top: 0.5rem;
}
</style>
</head>
<body>

<header class="px-4 py-4 bg-[rgba(15,0,30,.95)] border-b border-purple-500/40 sticky top-0 z-50 backdrop-blur-md">
  <div class="max-w-4xl mx-auto flex items-center justify-between">
    <a href="blog.html" class="btn-secondary btn">â† Blog</a>
    <h1 class="text-xl font-bold">Blog Admin</h1>
    <a href="index.html" class="btn-secondary btn" style="font-size: 0.9rem; padding: 0.5rem 1rem;">
      ğŸ  Home
    </a>
  </div>
</header>

<main class="max-w-4xl mx-auto px-4 py-8">
  
  <!-- Tabs -->
  <div style="display: flex; gap: 1rem; margin-bottom: 2rem; border-bottom: 2px solid rgba(124, 58, 237, 0.3);">
    <button id="writeTab" class="tab-btn active" onclick="switchTab('write')" style="padding: 0.75rem 1.5rem; background: none; border: none; border-bottom: 2px solid #a855f7; color: #a855f7; font-weight: 600; cursor: pointer; margin-bottom: -2px;">
      âœï¸ Write New Post
    </button>
    <button id="manageTab" class="tab-btn" onclick="switchTab('manage')" style="padding: 0.75rem 1.5rem; background: none; border: none; border-bottom: 2px solid transparent; color: #eae6ff; font-weight: 600; cursor: pointer; margin-bottom: -2px; opacity: 0.7;">
      ğŸ“ Manage Posts
    </button>
  </div>

  <!-- Write Tab -->
  <div id="writeSection">
    <div class="card">
      <h2 style="font-size: 1.75rem; font-weight: bold; margin-bottom: 1.5rem; color: #a855f7;">
        <span id="formTitle">Create New Post</span>
      </h2>

      <form id="postForm">
        <input type="hidden" id="postId">
        
        <div class="form-group">
          <label for="title">Post Title *</label>
          <input type="text" id="title" class="input" placeholder="Enter an engaging title..." required>
          <div class="help-text">Make it catchy and descriptive</div>
        </div>

        <div class="form-group">
          <label for="excerpt">Excerpt / Summary *</label>
          <textarea id="excerpt" class="textarea" style="min-height: 80px;" placeholder="Brief summary that appears in post listings..." required></textarea>
          <div class="help-text">1-2 sentences that hook readers</div>
        </div>

        <div class="form-group">
          <label for="content">Post Content *</label>
          <textarea id="content" class="textarea" placeholder="Write your post here...

# Use headers like this
## And subheaders like this

Write paragraphs normally.

Break lines with double enters." required></textarea>
          <div class="help-text">
            Use # for headers, ## for subheaders. Double line breaks create paragraphs.
          </div>
        </div>

        <div class="form-group">
          <label for="category">Category *</label>
          <select id="category" class="select" required>
            <option value="">Select a category...</option>
            <option value="music-tips">ğŸµ Music Tips</option>
            <option value="industry-news">ğŸ“° Industry News</option>
            <option value="artist-stories">ğŸ¤ Artist Stories</option>
            <option value="tutorials">ğŸ“š Tutorials</option>
            <option value="announcements">ğŸ“¢ Announcements</option>
            <option value="community">ğŸ’ Community</option>
          </select>
        </div>

        <div class="form-group">
          <label for="author">Author Name *</label>
          <input type="text" id="author" class="input" placeholder="Your name or 8BFR Team" required>
        </div>

        <div class="form-group">
          <label for="readTime">Estimated Read Time (minutes) *</label>
          <input type="number" id="readTime" class="input" min="1" max="60" value="5" required>
          <div class="help-text">Rough estimate: 200-250 words = 1 minute</div>
        </div>

        <div class="form-group">
          <label for="image">Featured Image Emoji (optional)</label>
          <input type="text" id="image" class="input" placeholder="ğŸ“°" maxlength="2">
          <div class="help-text">Enter an emoji to represent this post (e.g., ğŸµ ğŸ¤ ğŸ“)</div>
        </div>

        <div class="form-group">
          <label style="display: flex; align-items: center; cursor: pointer;">
            <input type="checkbox" id="featured" class="checkbox">
            <span>â­ Mark as Featured Post</span>
          </label>
          <div class="help-text">Featured posts appear at the top of the blog</div>
        </div>

        <div style="display: flex; gap: 1rem; flex-wrap: wrap; padding-top: 1rem; border-top: 1px solid rgba(124, 58, 237, 0.3);">
          <button type="submit" class="btn">
            <span id="submitBtnText">ğŸ“¤ Publish Post</span>
          </button>
          <button type="button" class="btn btn-secondary" onclick="resetForm()">
            ğŸ”„ Clear Form
          </button>
          <button type="button" class="btn btn-secondary" onclick="previewPost()" style="margin-left: auto;">
            ğŸ‘ï¸ Preview
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Manage Tab -->
  <div id="manageSection" style="display: none;">
    <div class="card">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h2 style="font-size: 1.75rem; font-weight: bold; color: #a855f7;">
          Manage Posts
        </h2>
        <div style="font-size: 0.9rem; opacity: 0.8;">
          <span id="postCount">0</span> posts
        </div>
      </div>

      <div id="postsList"></div>

      <div id="emptyPosts" style="display: none; text-align: center; padding: 3rem 1rem;">
        <div style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;">ğŸ“­</div>
        <p style="font-size: 1.1rem; opacity: 0.8;">No posts yet. Create your first one!</p>
      </div>
    </div>
  </div>

</main>

<script src="scripts.js?v=6" defer></script>

<script>
let currentEditId = null;

// Tab switching
function switchTab(tab) {
  const writeTab = document.getElementById('writeTab');
  const manageTab = document.getElementById('manageTab');
  const writeSection = document.getElementById('writeSection');
  const manageSection = document.getElementById('manageSection');
  
  if (tab === 'write') {
    writeTab.classList.add('active');
    manageTab.classList.remove('active');
    writeTab.style.borderBottom = '2px solid #a855f7';
    writeTab.style.color = '#a855f7';
    writeTab.style.opacity = '1';
    manageTab.style.borderBottom = '2px solid transparent';
    manageTab.style.opacity = '0.7';
    manageTab.style.color = '#eae6ff';
    writeSection.style.display = 'block';
    manageSection.style.display = 'none';
  } else {
    manageTab.classList.add('active');
    writeTab.classList.remove('active');
    manageTab.style.borderBottom = '2px solid #a855f7';
    manageTab.style.color = '#a855f7';
    manageTab.style.opacity = '1';
    writeTab.style.borderBottom = '2px solid transparent';
    writeTab.style.opacity = '0.7';
    writeTab.style.color = '#eae6ff';
    writeSection.style.display = 'none';
    manageSection.style.display = 'block';
    loadPostsList();
  }
}

// Form submission
document.getElementById('postForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  const posts = JSON.parse(localStorage.getItem('blog_posts') || '[]');
  
  const postData = {
    id: currentEditId || Date.now(),
    title: document.getElementById('title').value.trim(),
    slug: createSlug(document.getElementById('title').value),
    excerpt: document.getElementById('excerpt').value.trim(),
    content: document.getElementById('content').value.trim(),
    category: document.getElementById('category').value,
    author: document.getElementById('author').value.trim(),
    date: currentEditId ? 
      posts.find(p => p.id === currentEditId).date : 
      new Date().toISOString(),
    image: document.getElementById('image').value.trim(),
    featured: document.getElementById('featured').checked,
    views: currentEditId ? 
      posts.find(p => p.id === currentEditId).views || 0 : 
      0,
    readTime: parseInt(document.getElementById('readTime').value)
  };
  
  if (currentEditId) {
    // Update existing post
    const index = posts.findIndex(p => p.id === currentEditId);
    posts[index] = postData;
    alert('âœ… Post updated successfully!');
  } else {
    // Add new post
    posts.unshift(postData);
    alert('âœ… Post published successfully!');
  }
  
  localStorage.setItem('blog_posts', JSON.stringify(posts));
  resetForm();
  switchTab('manage');
});

// Create URL-friendly slug
function createSlug(title) {
  return title
    .toLowerCase()
    .replace(/[^a-z0-9]+/g, '-')
    .replace(/^-|-$/g, '');
}

// Reset form
function resetForm() {
  document.getElementById('postForm').reset();
  currentEditId = null;
  document.getElementById('postId').value = '';
  document.getElementById('formTitle').textContent = 'Create New Post';
  document.getElementById('submitBtnText').textContent = 'ğŸ“¤ Publish Post';
}

// Load posts list for management
function loadPostsList() {
  const posts = JSON.parse(localStorage.getItem('blog_posts') || '[]');
  const list = document.getElementById('postsList');
  const emptyState = document.getElementById('emptyPosts');
  const countEl = document.getElementById('postCount');
  
  countEl.textContent = posts.length;
  
  if (posts.length === 0) {
    list.innerHTML = '';
    emptyState.style.display = 'block';
    return;
  }
  
  emptyState.style.display = 'none';
  
  list.innerHTML = posts
    .sort((a, b) => new Date(b.date) - new Date(a.date))
    .map(post => {
      const date = new Date(post.date).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
      });
      
      return `
        <div class="post-item">
          <div style="flex: 1;">
            <div style="font-weight: 600; margin-bottom: 0.25rem;">
              ${post.featured ? 'â­ ' : ''}${post.title}
            </div>
            <div style="font-size: 0.85rem; opacity: 0.7;">
              ${getCategoryName(post.category)} â€¢ ${date} â€¢ ${post.views} views
            </div>
          </div>
          <div style="display: flex; gap: 0.5rem;">
            <button onclick="editPost(${post.id})" class="btn btn-secondary" style="padding: 0.5rem 1rem; font-size: 0.9rem;">
              âœï¸ Edit
            </button>
            <button onclick="deletePost(${post.id})" class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.9rem;">
              ğŸ—‘ï¸ Delete
            </button>
          </div>
        </div>
      `;
    }).join('');
}

// Edit post
function editPost(id) {
  const posts = JSON.parse(localStorage.getItem('blog_posts') || '[]');
  const post = posts.find(p => p.id === id);
  
  if (!post) return;
  
  currentEditId = id;
  
  document.getElementById('title').value = post.title;
  document.getElementById('excerpt').value = post.excerpt;
  document.getElementById('content').value = post.content;
  document.getElementById('category').value = post.category;
  document.getElementById('author').value = post.author;
  document.getElementById('readTime').value = post.readTime;
  document.getElementById('image').value = post.image || '';
  document.getElementById('featured').checked = post.featured;
  
  document.getElementById('formTitle').textContent = 'Edit Post';
  document.getElementById('submitBtnText').textContent = 'ğŸ’¾ Update Post';
  
  switchTab('write');
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// Delete post
function deletePost(id) {
  if (!confirm('Are you sure you want to delete this post? This cannot be undone.')) {
    return;
  }
  
  const posts = JSON.parse(localStorage.getItem('blog_posts') || '[]');
  const filtered = posts.filter(p => p.id !== id);
  localStorage.setItem('blog_posts', JSON.stringify(filtered));
  
  loadPostsList();
  alert('âœ… Post deleted successfully.');
}

// Preview post
function previewPost() {
  const title = document.getElementById('title').value;
  const content = document.getElementById('content').value;
  const category = document.getElementById('category').value;
  
  if (!title || !content || !category) {
    alert('âš ï¸ Please fill in at least the title, content, and category to preview.');
    return;
  }
  
  // Create temporary post
  const tempPost = {
    id: 'preview',
    title: title,
    excerpt: document.getElementById('excerpt').value || 'Preview',
    content: content,
    category: category,
    author: document.getElementById('author').value || 'Author',
    date: new Date().toISOString(),
    image: document.getElementById('image').value,
    featured: false,
    views: 0,
    readTime: parseInt(document.getElementById('readTime').value) || 5
  };
  
  // Save to sessionStorage
  sessionStorage.setItem('preview_post', JSON.stringify(tempPost));
  
  // Open preview in new tab
  window.open('blog-post.html?id=preview', '_blank');
}

// Get category name
function getCategoryName(slug) {
  const names = {
    'music-tips': 'ğŸµ Music Tips',
    'industry-news': 'ğŸ“° Industry News',
    'artist-stories': 'ğŸ¤ Artist Stories',
    'tutorials': 'ğŸ“š Tutorials',
    'announcements': 'ğŸ“¢ Announcements',
    'community': 'ğŸ’ Community'
  };
  return names[slug] || slug;
}

// Load author name from user data
document.addEventListener('DOMContentLoaded', function() {
  const currentUser = localStorage.getItem('currentUser_v1');
  if (currentUser && !document.getElementById('author').value) {
    document.getElementById('author').value = currentUser;
  }
});
</script>
  <!-- ADD THIS SCRIPT TO EVERY PAGE (except index.html where you want it always shown) -->
<!-- Place it right before the closing </body> tag -->

<script>
// Avatar & Bubble Toggle System
(function() {
    // Create toggle button
    const toggleBtn = document.createElement('button');
    toggleBtn.id = 'avatarToggle';
    toggleBtn.innerHTML = 'ğŸ‘ï¸';
    toggleBtn.title = 'Toggle Avatar/Bubbles';
    toggleBtn.style.cssText = `
        position: fixed;
        top: 80px;
        right: 20px;
        z-index: 9999;
        background: rgba(124, 58, 237, 0.9);
        border: 2px solid rgba(124, 58, 237, 1);
        color: white;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 12px rgba(124, 58, 237, 0.5);
        transition: all 0.3s ease;
    `;
    
    toggleBtn.addEventListener('mouseenter', function() {
        this.style.transform = 'scale(1.1)';
    });
    
    toggleBtn.addEventListener('mouseleave', function() {
        this.style.transform = 'scale(1)';
    });
    
    document.body.appendChild(toggleBtn);
    
    // Load saved preference
    let isHidden = localStorage.getItem('hideAvatarBubbles') === 'true';
    
    function updateVisibility() {
        const elementsToToggle = [
            document.getElementById('homeAvatarSwitcher'),
            ...document.querySelectorAll('[id*="bubble"]'),
            ...document.querySelectorAll('[class*="bubble"]'),
            ...document.querySelectorAll('[id*="avatar"][id*="switcher"]')
        ];
        
        elementsToToggle.forEach(el => {
            if (el) {
                el.style.display = isHidden ? 'none' : '';
            }
        });
        
        toggleBtn.innerHTML = isHidden ? 'ğŸ‘ï¸â€ğŸ—¨ï¸' : 'ğŸ‘ï¸';
        toggleBtn.title = isHidden ? 'Show Avatar/Bubbles' : 'Hide Avatar/Bubbles';
    }
    
    toggleBtn.addEventListener('click', function() {
        isHidden = !isHidden;
        localStorage.setItem('hideAvatarBubbles', isHidden);
        updateVisibility();
    });
    
    // Apply on load
    updateVisibility();
    
    // Watch for dynamically added elements
    const observer = new MutationObserver(updateVisibility);
    observer.observe(document.body, { childList: true, subtree: true });
})();
</script>


</body>
</html>
