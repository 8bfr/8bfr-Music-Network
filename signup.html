<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sign up - 8BFR Music Network</title>
  <style>
    body { background:#0a0a0a;color:#fff;font-family:Inter,system-ui; padding:1rem; }
    .card{max-width:760px;margin:0 auto;background:#111;padding:1.5rem;border-radius:8px;border:1px solid #222;}
    label{display:block;margin:.5rem 0;color:#ccc;font-weight:600;}
    input, textarea, select{width:100%;padding:.6rem;border-radius:6px;border:1px solid #333;background:#070707;color:#fff}
    .btn{background:#ff0066;color:#fff;padding:.8rem 1rem;border:none;border-radius:6px;cursor:pointer;margin-top:1rem;width:100%;font-weight:600;}
    .muted{color:#999;font-size:.9rem}
    .error{color:#ff4444;background:rgba(255,68,68,0.1);padding:.5rem;border-radius:4px;margin:.5rem 0;}
    .success{color:#44ff88;background:rgba(68,255,136,0.1);padding:.5rem;border-radius:4px;margin:.5rem 0;}
    .checkbox-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:.5rem;max-height:300px;overflow-y:auto;padding:.5rem;background:#0a0a0a;border:1px solid #333;border-radius:4px;margin-top:.5rem;}
    .checkbox-item{display:flex;align-items:center;gap:.5rem;}
    .checkbox-item input{width:auto;}
    .checkbox-item label{margin:0;cursor:pointer;font-size:.85rem;font-weight:400;}
    .password-container{position:relative;}
    .toggle-password{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;color:#999;cursor:pointer;padding:5px;font-size:1.2rem;}
  </style>
</head>
<body>
  <div class="card">
    <h2>Create Account - 8BFR Music Network</h2>
    <p class="muted">This form works WITHOUT JavaScript - all fields are pure HTML</p>

    <form id="signupForm">
      <label>Email *</label>
      <input name="email" type="email" required placeholder="your.email@example.com" />

      <label>Password * (min 6 characters)</label>
      <div class="password-container">
        <input id="password" name="password" type="password" required minlength="6" placeholder="Enter secure password" />
        <button type="button" class="toggle-password" onclick="togglePassword('password')">üëÅÔ∏è</button>
      </div>

      <label>Confirm Password *</label>
      <div class="password-container">
        <input id="confirmPassword" type="password" required minlength="6" placeholder="Re-enter password" />
        <button type="button" class="toggle-password" onclick="togglePassword('confirmPassword')">üëÅÔ∏è</button>
      </div>

      <label>Username * (unique, no spaces)</label>
      <input name="username" type="text" required placeholder="yourusername" />

      <label>Display Name</label>
      <input name="display_name" type="text" placeholder="Your Display Name" />

      <label>Bio</label>
      <textarea name="bio" rows="3" placeholder="Tell us about yourself..."></textarea>

      <label>Roles (check all that apply) *</label>
      <div class="checkbox-grid">
        <div class="checkbox-item"><input type="checkbox" name="roles" value="fan" id="r1"><label for="r1">fan</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="artist" id="r2"><label for="r2">artist</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="beatmaker" id="r3"><label for="r3">beatmaker</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="producer" id="r4"><label for="r4">producer</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="singer" id="r5"><label for="r5">singer</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="musician" id="r6"><label for="r6">musician</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="engineer" id="r7"><label for="r7">engineer</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="songwriter" id="r8"><label for="r8">songwriter</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="dj" id="r9"><label for="r9">dj</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="label" id="r10"><label for="r10">label</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="promoter" id="r11"><label for="r11">promoter</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="videographer" id="r12"><label for="r12">videographer</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="photographer" id="r13"><label for="r13">photographer</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="filmmaker" id="r14"><label for="r14">filmmaker</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="podcaster" id="r15"><label for="r15">podcaster</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="distributor" id="r16"><label for="r16">distributor</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="rapper" id="r17"><label for="r17">rapper</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="designer" id="r18"><label for="r18">designer</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="author" id="r19"><label for="r19">author</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="blogger" id="r20"><label for="r20">blogger</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="game_creator" id="r21"><label for="r21">game creator</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="developer" id="r22"><label for="r22">developer</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="streamer" id="r23"><label for="r23">streamer</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="gamer" id="r24"><label for="r24">gamer</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="influencer" id="r25"><label for="r25">influencer</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="brand_ambassador" id="r26"><label for="r26">brand ambassador</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="community_leader" id="r27"><label for="r27">community leader</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="parent" id="r28"><label for="r28">parent</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="student" id="r29"><label for="r29">student</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="educator" id="r30"><label for="r30">educator</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="supporter" id="r31"><label for="r31">supporter</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="collector" id="r32"><label for="r32">collector</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="mentor" id="r33"><label for="r33">mentor</label></div>
        <div class="checkbox-item"><input type="checkbox" name="roles" value="kids" id="r34"><label for="r34">kids</label></div>
      </div>

      <label>Verification Link (optional - for artists/creators)</label>
      <input name="verification_link" type="url" placeholder="https://spotify.com/artist/... or similar" />

      <label>Badges (optional - check any that apply)</label>
      <div class="checkbox-grid">
        <div class="checkbox-item"><input type="checkbox" name="badges" value="verified" id="b1"><label for="b1">verified</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="founder" id="b2"><label for="b2">founder</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="8bfrfan" id="b3"><label for="b3">8bfrfan</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="fyp" id="b4"><label for="b4">fyp</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="g7" id="b5"><label for="b5">g7</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="donor" id="b6"><label for="b6">donor</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="sponsor" id="b7"><label for="b7">sponsor</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="early_supporter" id="b8"><label for="b8">early supporter</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="top_creator" id="b9"><label for="b9">top creator</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="trending" id="b10"><label for="b10">trending</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="vip_member" id="b11"><label for="b11">vip member</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="beta_tester" id="b12"><label for="b12">beta tester</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="contest_winner" id="b13"><label for="b13">contest winner</label></div>
        <div class="checkbox-item"><input type="checkbox" name="badges" value="tournament_champion" id="b14"><label for="b14">tournament champion</label></div>
      </div>

      <div id="message"></div>

      <button type="submit" class="btn">Create Account</button>
      
      <p class="muted" style="text-align:center;margin-top:1rem;">
        Already have an account? <a href="login.html" style="color:#ff0066;">Login here</a>
      </p>
    </form>
  </div>

  <script>
    // This will ONLY run if JavaScript works
    document.getElementById('message').innerHTML = '<div class="success">‚úÖ JavaScript is working! Form will work properly.</div>';
    
    function togglePassword(fieldId) {
      const field = document.getElementById(fieldId);
      if (field.type === 'password') {
        field.type = 'text';
      } else {
        field.type = 'password';
      }
    }
    
    document.getElementById('signupForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const form = e.target;
      const formData = new FormData(form);
      
      const email = formData.get('email');
      const password = formData.get('password');
      const confirmPassword = document.getElementById('confirmPassword').value;
      const username = formData.get('username');
      const display_name = formData.get('display_name');
      const bio = formData.get('bio');
      const verification_link = formData.get('verification_link');
      
      const roles = formData.getAll('roles');
      const badges = formData.getAll('badges');
      
      const msg = document.getElementById('message');
      
      if (password !== confirmPassword) {
        msg.innerHTML = '<div class="error">Passwords do not match!</div>';
        return;
      }
      
      if (roles.length === 0) {
        msg.innerHTML = '<div class="error">Please select at least one role.</div>';
        return;
      }
      
      msg.innerHTML = '<div class="muted">Creating account... (This will show Supabase error if library not loaded)</div>';
      
      // Try to use Supabase
      if (typeof window.supabase === 'undefined') {
        msg.innerHTML = '<div class="error"><strong>Supabase library failed to load!</strong><br><br>Your browser is blocking the CDN. You need to:<br>1. Use Supabase dashboard to create account manually, OR<br>2. Try a different browser, OR<br>3. Tell me and I\'ll create a server-side signup solution.</div>';
        return;
      }
      
      try {
        const supabase = window.supabase.createClient(
          'https://novbuvwpjnxwwvdekjhr.supabase.co',
          'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5vdmJ1dndwam54d3d2ZGVramhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjExODkxODUsImV4cCI6MjA3Njc2NTE4NX0.1UUkdGafh6ZplAX8hi7Bvj94D2gvFQZUl0an1RvcSA0'
        );
        
        const { data, error } = await supabase.auth.signUp({
          email: email,
          password: password
        });
        
        if (error) throw error;
        
        const user = data.user;
        
        // Create profile
        const allTags = [...roles, ...badges];
        await supabase.from('profiles').insert({
          user_id: user.id,
          email: email,
          username: username,
          display_name: display_name || username,
          role: roles[0],
          bio: bio,
          badges: allTags,
          verify_url: verification_link || null,
          created_at: new Date().toISOString()
        });
        
        msg.innerHTML = '<div class="success">‚úÖ Account created! Check your email to confirm.</div>';
        setTimeout(() => location.href = 'login.html', 2000);
        
      } catch (err) {
        msg.innerHTML = '<div class="error">Error: ' + err.message + '</div>';
      }
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- ADD THIS SCRIPT TO EVERY PAGE (except index.html where you want it always shown) -->
<!-- Place it right before the closing </body> tag -->

<script>
// Avatar & Bubble Toggle System
(function() {
    // Create toggle button
    const toggleBtn = document.createElement('button');
    toggleBtn.id = 'avatarToggle';
    toggleBtn.innerHTML = 'üëÅÔ∏è';
    toggleBtn.title = 'Toggle Avatar/Bubbles';
    toggleBtn.style.cssText = `
        position: fixed;
        top: 80px;
        right: 20px;
        z-index: 9999;
        background: rgba(124, 58, 237, 0.9);
        border: 2px solid rgba(124, 58, 237, 1);
        color: white;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 12px rgba(124, 58, 237, 0.5);
        transition: all 0.3s ease;
    `;
    
    toggleBtn.addEventListener('mouseenter', function() {
        this.style.transform = 'scale(1.1)';
    });
    
    toggleBtn.addEventListener('mouseleave', function() {
        this.style.transform = 'scale(1)';
    });
    
    document.body.appendChild(toggleBtn);
    
    // Load saved preference
    let isHidden = localStorage.getItem('hideAvatarBubbles') === 'true';
    
    function updateVisibility() {
        const elementsToToggle = [
            document.getElementById('homeAvatarSwitcher'),
            ...document.querySelectorAll('[id*="bubble"]'),
            ...document.querySelectorAll('[class*="bubble"]'),
            ...document.querySelectorAll('[id*="avatar"][id*="switcher"]')
        ];
        
        elementsToToggle.forEach(el => {
            if (el) {
                el.style.display = isHidden ? 'none' : '';
            }
        });
        
        toggleBtn.innerHTML = isHidden ? 'üëÅÔ∏è‚Äçüó®Ô∏è' : 'üëÅÔ∏è';
        toggleBtn.title = isHidden ? 'Show Avatar/Bubbles' : 'Hide Avatar/Bubbles';
    }
    
    toggleBtn.addEventListener('click', function() {
        isHidden = !isHidden;
        localStorage.setItem('hideAvatarBubbles', isHidden);
        updateVisibility();
    });
    
    // Apply on load
    updateVisibility();
    
    // Watch for dynamically added elements
    const observer = new MutationObserver(updateVisibility);
    observer.observe(document.body, { childList: true, subtree: true });
})();
</script>

</body>
</html>
