<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Community Feed ‚Äî 8BFR Music Network</title>
<link rel="icon" href="assets/images/favicon.png" />
<script src="https://cdn.tailwindcss.com"></script>
<style>
  * { box-sizing: border-box; }
  body {
    background: linear-gradient(#0b0014, #000);
    color: #eae6ff;
    font-family: system-ui, -apple-system, sans-serif;
    margin: 0;
    padding: 0;
  }
  
  /* Header */
  .header {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(15, 0, 30, 0.95);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(124, 58, 237, 0.3);
  }
  
  /* Tab System */
  .tabs {
    display: flex;
    gap: 0;
    border-bottom: 1px solid rgba(124, 58, 237, 0.2);
  }
  
  .tab {
    flex: 1;
    padding: 1rem;
    background: transparent;
    border: none;
    color: #a855f7;
    font-size: 0.95rem;
    font-weight: 600;
    cursor: pointer;
    position: relative;
    transition: all 0.2s;
  }
  
  .tab:hover {
    background: rgba(124, 58, 237, 0.1);
  }
  
  .tab.active {
    color: #fff;
  }
  
  .tab.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, #7c3aed, #a855f7);
    border-radius: 3px 3px 0 0;
  }
  
  /* Feed Container */
  .feed-container {
    max-width: 600px;
    margin: 0 auto;
    padding: 0;
  }
  
  /* PROMOTED AD SECTION */
  .promoted-ad-section {
    background: linear-gradient(135deg, rgba(124, 58, 237, 0.2), rgba(0, 217, 255, 0.1));
    border: 1px solid rgba(124, 58, 237, 0.4);
    border-radius: 16px;
    padding: 1rem;
    margin: 1rem 0;
    position: relative;
    overflow: hidden;
  }
  
  .promoted-badge {
    position: absolute;
    top: 0.75rem;
    right: 0.75rem;
    background: rgba(245, 158, 11, 0.9);
    color: #fff;
    padding: 0.3rem 0.75rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 700;
    z-index: 10;
  }
  
  .ad-timer {
    position: absolute;
    top: 0.75rem;
    left: 0.75rem;
    background: rgba(0, 0, 0, 0.7);
    color: #00d9ff;
    padding: 0.3rem 0.75rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    z-index: 10;
  }
  
  .ad-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid rgba(124, 58, 237, 0.3);
    font-size: 0.8rem;
    color: #a855f7;
  }
  
  .ad-footer a {
    color: #00d9ff;
    text-decoration: none;
    font-weight: 600;
  }
  
  /* Post Card */
  .post-card {
    background: rgba(15, 0, 30, 0.6);
    border-bottom: 8px solid rgba(124, 58, 237, 0.15);
    padding: 1rem;
    position: relative;
  }
  
  .post-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.75rem;
  }
  
  .post-avatar {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: linear-gradient(135deg, #7c3aed, #a855f7);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 1.1rem;
    color: white;
    flex-shrink: 0;
  }
  
  .post-user-info {
    flex: 1;
    min-width: 0;
  }
  
  .post-username {
    font-weight: 700;
    font-size: 0.95rem;
    color: #fff;
    display: flex;
    align-items: center;
    gap: 0.4rem;
  }
  
  .verified-badge {
    color: #00d9ff;
    font-size: 0.9rem;
  }
  
  .post-time {
    font-size: 0.8rem;
    color: #a855f7;
    opacity: 0.7;
  }
  
  .follow-btn {
    padding: 0.4rem 1rem;
    background: transparent;
    border: 1px solid #a855f7;
    color: #a855f7;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .follow-btn:hover {
    background: #a855f7;
    color: white;
  }
  
  .follow-btn.following {
    background: #a855f7;
    color: white;
    border-color: #a855f7;
  }
  
  /* Post Content */
  .post-text {
    margin-bottom: 0.75rem;
    line-height: 1.5;
    font-size: 0.95rem;
    color: #eae6ff;
  }
  
  .post-media {
    margin-bottom: 0.75rem;
    border-radius: 12px;
    overflow: hidden;
    background: #000;
  }
  
  .post-media img,
  .post-media video {
    width: 100%;
    display: block;
    max-height: 500px;
    object-fit: contain;
  }
  
  /* Interaction Bar */
  .interaction-bar {
    display: flex;
    justify-content: space-between;
    padding-top: 0.75rem;
    border-top: 1px solid rgba(124, 58, 237, 0.2);
  }
  
  .interaction-btn {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    background: transparent;
    border: none;
    color: #a855f7;
    padding: 0.5rem 0.75rem;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.85rem;
    transition: all 0.2s;
  }
  
  .interaction-btn:hover {
    background: rgba(124, 58, 237, 0.2);
  }
  
  .interaction-btn.active {
    color: #00d9ff;
  }
  
  .interaction-btn.liked {
    color: #ef4444;
  }
  
  .interaction-count {
    font-weight: 600;
    font-size: 0.9rem;
  }
  
  /* Action Buttons Row */
  .action-row {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid rgba(124, 58, 237, 0.15);
  }
  
  .action-btn {
    flex: 1;
    padding: 0.6rem;
    background: rgba(124, 58, 237, 0.15);
    border: 1px solid rgba(124, 58, 237, 0.3);
    color: #a855f7;
    border-radius: 8px;
    font-size: 0.8rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.3rem;
  }
  
  .action-btn:hover {
    background: rgba(124, 58, 237, 0.3);
    border-color: rgba(124, 58, 237, 0.5);
  }
  
  .action-btn.active {
    background: rgba(0, 217, 255, 0.2);
    border-color: rgba(0, 217, 255, 0.4);
    color: #00d9ff;
  }
  
  /* Comments Section */
  .comments-section {
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid rgba(124, 58, 237, 0.15);
    display: none;
  }
  
  .comments-section.open {
    display: block;
  }
  
  .comment {
    padding: 0.75rem;
    background: rgba(124, 58, 237, 0.05);
    border-radius: 8px;
    margin-bottom: 0.5rem;
  }
  
  .comment-header {
    display: flex;
    gap: 0.5rem;
    align-items: center;
    margin-bottom: 0.4rem;
  }
  
  .comment-avatar {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: linear-gradient(135deg, #7c3aed, #a855f7);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
    font-weight: 700;
  }
  
  .comment-username {
    font-weight: 600;
    font-size: 0.85rem;
  }
  
  .comment-time {
    font-size: 0.75rem;
    color: #a855f7;
    opacity: 0.6;
  }
  
  .comment-text {
    font-size: 0.9rem;
    line-height: 1.4;
    padding-left: 36px;
  }
  
  .comment-input-box {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.75rem;
  }
  
  .comment-input {
    flex: 1;
    padding: 0.75rem;
    background: rgba(18, 3, 39, 0.8);
    border: 1px solid rgba(124, 58, 237, 0.3);
    border-radius: 8px;
    color: #fff;
    font-size: 0.9rem;
  }
  
  .comment-input:focus {
    outline: none;
    border-color: #a855f7;
  }
  
  .comment-submit {
    padding: 0.75rem 1.25rem;
    background: #7c3aed;
    border: none;
    color: white;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .comment-submit:hover {
    background: #6d28d9;
  }
</style>
</head>
<body>

<!-- Header -->
<header class="header">
  <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
    <a href="index.html" style="color: #a855f7; text-decoration: none; font-weight: 600;">‚Üê Home</a>
    <h1 style="font-size: 1.25rem; font-weight: 800;">üì∞ Community Feed</h1>
    <span style="width: 80px;"></span>
  </div>
  
  <!-- Tabs -->
  <div class="tabs">
    <button class="tab active" data-tab="all">For You</button>
    <button class="tab" data-tab="friends">Friends</button>
    <button class="tab" data-tab="trending">Trending</button>
  </div>
</header>

<!-- Main Feed -->
<main class="feed-container">
  
  <!-- PROMOTED AD SECTION -->
  <section id="feedAdSection" class="promoted-ad-section" style="display:none;">
    <div class="promoted-badge">üì¢ PROMOTED</div>
    <div class="ad-timer">‚è±Ô∏è <span id="adTimer">23:45:12</span></div>
    <div id="feedAdContent" style="margin-top: 2rem;">
      <!-- Ad content loads here -->
    </div>
    <div class="ad-footer">
      <div>üí∞ $1/hour promotion</div>
      <a href="feed-ads.html">Promote Your Post ‚Üí</a>
    </div>
  </section>
  
  <!-- Feed Posts -->
  <div id="feedContent">
    <!-- Posts load here -->
  </div>
</main>

<script src="scripts.js?v=6" defer></script>

<script>
// ===== FEED SYSTEM =====
const $ = (s) => document.querySelector(s);
const $$ = (s) => Array.from(document.querySelectorAll(s));

let currentTab = 'all';
const currentUser = {
  id: 'user_' + Date.now(),
  username: localStorage.getItem('username') || 'User',
  avatar: 'üéµ'
};

// ===== FEED AD SYSTEM ($1/HOUR) =====
const FeedAdSystem = {
  currentAd: null,
  timerInterval: null,
  
  init() {
    this.loadCurrentAd();
    if (this.currentAd) {
      this.startTimer();
    }
  },
  
  loadCurrentAd() {
    const ads = this.getActiveAds();
    
    if (ads.length === 0) {
      $('#feedAdSection').style.display = 'none';
      return;
    }
    
    this.currentAd = ads[0];
    this.renderAd();
    $('#feedAdSection').style.display = 'block';
  },
  
  getActiveAds() {
    const ads = JSON.parse(localStorage.getItem('feed_ads') || '[]');
    const now = Date.now();
    
    const activeAds = ads.filter(ad => {
      const endTime = ad.startTime + (ad.hours * 60 * 60 * 1000);
      return now < endTime;
    });
    
    if (activeAds.length !== ads.length) {
      localStorage.setItem('feed_ads', JSON.stringify(activeAds));
    }
    
    return activeAds.sort((a, b) => {
      const aEnd = a.startTime + (a.hours * 60 * 60 * 1000);
      const bEnd = b.startTime + (b.hours * 60 * 60 * 1000);
      return aEnd - bEnd;
    });
  },
  
  renderAd() {
    if (!this.currentAd) return;
    
    const post = this.currentAd.post;
    const contentEl = $('#feedAdContent');
    
    contentEl.innerHTML = `
      <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
        <div style="width: 44px; height: 44px; border-radius: 50%; background: linear-gradient(135deg, #7c3aed, #a855f7); display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.1rem; color: white;">
          ${post.avatar || 'üéµ'}
        </div>
        <div style="flex: 1;">
          <div style="font-weight: 700; font-size: 0.95rem; color: #fff;">
            ${post.username || 'User'}
            ${post.verified ? '<span style="color: #00d9ff;">‚úì</span>' : ''}
          </div>
          <div style="font-size: 0.8rem; color: #a855f7; opacity: 0.7;">${this.timeAgo(post.timestamp || Date.now())}</div>
        </div>
      </div>
      
      ${post.text ? `<div style="margin-bottom: 0.75rem; line-height: 1.5;">${post.text}</div>` : ''}
      
      ${post.media ? `
        <div style="margin-bottom: 0.75rem; border-radius: 12px; overflow: hidden; background: #000;">
          <img src="${post.media}" style="width: 100%; display: block; max-height: 500px; object-fit: contain;">
        </div>
      ` : ''}
      
      <div style="display: flex; justify-content: space-around; padding-top: 0.75rem; border-top: 1px solid rgba(124, 58, 237, 0.2);">
        <button style="display: flex; align-items: center; gap: 0.4rem; background: transparent; border: none; color: #a855f7; padding: 0.5rem; cursor: pointer;">
          ü§ç <span>${post.likes || 0}</span>
        </button>
        <button style="display: flex; align-items: center; gap: 0.4rem; background: transparent; border: none; color: #a855f7; padding: 0.5rem; cursor: pointer;">
          üí¨ <span>${post.comments || 0}</span>
        </button>
        <button style="display: flex; align-items: center; gap: 0.4rem; background: transparent; border: none; color: #a855f7; padding: 0.5rem; cursor: pointer;">
          üì§
        </button>
      </div>
    `;
  },
  
  startTimer() {
    this.updateTimer();
    this.timerInterval = setInterval(() => this.updateTimer(), 1000);
  },
  
  updateTimer() {
    if (!this.currentAd) return;
    
    const now = Date.now();
    const endTime = this.currentAd.startTime + (this.currentAd.hours * 60 * 60 * 1000);
    const remaining = endTime - now;
    
    if (remaining <= 0) {
      this.loadCurrentAd();
      return;
    }
    
    const hours = Math.floor(remaining / (1000 * 60 * 60));
    const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((remaining % (1000 * 60)) / 1000);
    
    const timerEl = $('#adTimer');
    if (timerEl) {
      timerEl.textContent = `${hours}h ${minutes}m ${seconds}s`;
    }
  },
  
  timeAgo(timestamp) {
    const seconds = Math.floor((Date.now() - timestamp) / 1000);
    if (seconds < 60) return 'Just now';
    if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;
    if (seconds < 86400) return `${Math.floor(seconds / 3600)}h ago`;
    return `${Math.floor(seconds / 86400)}d ago`;
  }
};

// ===== MOCK DATA =====
function initializeMockData() {
  const existingPosts = localStorage.getItem('feed_posts');
  if (existingPosts) return;
  
  const mockPosts = [
    {
      id: 'post_1',
      userId: 'user_1',
      username: 'BeatMaster808',
      avatar: 'üéß',
      verified: true,
      text: 'Just dropped a new beat! üî• What y\'all think?',
      timestamp: Date.now() - 10800000,
      friends: true
    },
    {
      id: 'post_2',
      userId: 'user_2',
      username: 'VocalQueen',
      avatar: 'üé§',
      verified: true,
      text: 'Recording session vibes ‚ú®',
      timestamp: Date.now() - 18000000,
      friends: false
    }
  ];
  
  localStorage.setItem('feed_posts', JSON.stringify(mockPosts));
}

// ===== LOAD & RENDER =====
function loadPosts() {
  const posts = JSON.parse(localStorage.getItem('feed_posts') || '[]');
  return posts.sort((a, b) => b.timestamp - a.timestamp);
}

function getInteractions() {
  return JSON.parse(localStorage.getItem('feed_interactions') || '{}');
}

function saveInteractions(interactions) {
  localStorage.setItem('feed_interactions', JSON.stringify(interactions));
}

function renderFeed() {
  const posts = loadPosts();
  const interactions = getInteractions();
  const feedEl = $('#feedContent');
  
  let filteredPosts = posts;
  if (currentTab === 'friends') {
    filteredPosts = posts.filter(p => p.friends);
  } else if (currentTab === 'trending') {
    filteredPosts = posts.filter(p => {
      const int = interactions[p.id] || {};
      return (int.likes || 0) > 100;
    });
  }
  
  if (filteredPosts.length === 0) {
    feedEl.innerHTML = `
      <div style="text-align: center; padding: 4rem 2rem; color: #a855f7; opacity: 0.7;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">üì≠</div>
        <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 0.5rem;">No posts yet</div>
        <div style="font-size: 0.9rem;">${currentTab === 'friends' ? 'Follow some artists to see their posts here!' : 'Check back soon for new content!'}</div>
      </div>
    `;
    return;
  }
  
  feedEl.innerHTML = filteredPosts.map(post => {
    const postInt = interactions[post.id] || {
      liked: false,
      favorited: false,
      reposted: false,
      following: false,
      likes: Math.floor(Math.random() * 500),
      comments: [],
      reposts: Math.floor(Math.random() * 50),
      favorites: Math.floor(Math.random() * 100)
    };
    
    return `
      <div class="post-card" data-post-id="${post.id}">
        <div class="post-header">
          <div class="post-avatar">${post.avatar}</div>
          <div class="post-user-info">
            <div class="post-username">
              ${post.username}
              ${post.verified ? '<span class="verified-badge">‚úì</span>' : ''}
            </div>
            <div class="post-time">${timeAgo(post.timestamp)}</div>
          </div>
          ${post.userId !== currentUser.id ? `
            <button class="follow-btn ${postInt.following ? 'following' : ''}" onclick="toggleFollow('${post.id}')">
              ${postInt.following ? 'Following' : 'Follow'}
            </button>
          ` : ''}
        </div>
        
        ${post.text ? `<div class="post-text">${post.text}</div>` : ''}
        
        ${post.media ? `
          <div class="post-media">
            ${post.mediaType === 'video' 
              ? `<video controls><source src="${post.media}" type="video/mp4"></video>`
              : `<img src="${post.media}" alt="Post media">`
            }
          </div>
        ` : ''}
        
        <div class="interaction-bar">
          <button class="interaction-btn ${postInt.liked ? 'liked' : ''}" onclick="toggleLike('${post.id}')">
            ${postInt.liked ? '‚ù§Ô∏è' : 'ü§ç'}
            <span class="interaction-count">${postInt.likes}</span>
          </button>
          
          <button class="interaction-btn" onclick="toggleComments('${post.id}')">
            üí¨
            <span class="interaction-count">${postInt.comments.length}</span>
          </button>
          
          <button class="interaction-btn ${postInt.reposted ? 'active' : ''}" onclick="toggleRepost('${post.id}')">
            üîÅ
            <span class="interaction-count">${postInt.reposts}</span>
          </button>
          
          <button class="interaction-btn" onclick="sharePost('${post.id}')">
            üì§
          </button>
        </div>
        
        <div class="action-row">
          <button class="action-btn ${postInt.favorited ? 'active' : ''}" onclick="toggleFavorite('${post.id}')">
            ${postInt.favorited ? '‚≠ê' : '‚òÜ'} Favorite
          </button>
          <button class="action-btn" onclick="addToStory('${post.id}')">
            üì∏ Story
          </button>
        </div>
        
        <div class="comments-section" id="comments-${post.id}">
          <div id="comments-list-${post.id}">
            ${renderComments(postInt.comments)}
          </div>
          <div class="comment-input-box">
            <input type="text" class="comment-input" id="comment-input-${post.id}" placeholder="Add a comment...">
            <button class="comment-submit" onclick="addComment('${post.id}')">Post</button>
          </div>
        </div>
      </div>
    `;
  }).join('');
}

function renderComments(comments) {
  if (!comments || comments.length === 0) {
    return '<div style="text-align: center; padding: 1rem; color: #a855f7; opacity: 0.6; font-size: 0.85rem;">No comments yet</div>';
  }
  
  return comments.map(comment => `
    <div class="comment">
      <div class="comment-header">
        <div class="comment-avatar">${comment.avatar}</div>
        <div class="comment-username">${comment.username}</div>
        <div class="comment-time" style="margin-left: auto;">${timeAgo(comment.timestamp)}</div>
      </div>
      <div class="comment-text">${comment.text}</div>
    </div>
  `).join('');
}

// ===== INTERACTION FUNCTIONS =====
function toggleLike(postId) {
  const interactions = getInteractions();
  if (!interactions[postId]) {
    interactions[postId] = { liked: false, likes: 0, comments: [], reposts: 0, favorites: 0 };
  }
  
  interactions[postId].liked = !interactions[postId].liked;
  interactions[postId].likes += interactions[postId].liked ? 1 : -1;
  
  saveInteractions(interactions);
  renderFeed();
}

function toggleComments(postId) {
  const commentsSection = $(`#comments-${postId}`);
  commentsSection.classList.toggle('open');
}

function addComment(postId) {
  const input = $(`#comment-input-${postId}`);
  const text = input.value.trim();
  if (!text) return;
  
  const interactions = getInteractions();
  if (!interactions[postId]) {
    interactions[postId] = { liked: false, likes: 0, comments: [], reposts: 0, favorites: 0 };
  }
  
  interactions[postId].comments.push({
    username: currentUser.username,
    avatar: currentUser.avatar,
    text: text,
    timestamp: Date.now()
  });
  
  saveInteractions(interactions);
  input.value = '';
  renderFeed();
  
  setTimeout(() => {
    $(`#comments-${postId}`).classList.add('open');
  }, 100);
}

function toggleRepost(postId) {
  const interactions = getInteractions();
  if (!interactions[postId]) {
    interactions[postId] = { liked: false, likes: 0, comments: [], reposts: 0, favorites: 0, reposted: false };
  }
  
  interactions[postId].reposted = !interactions[postId].reposted;
  interactions[postId].reposts += interactions[postId].reposted ? 1 : -1;
  
  saveInteractions(interactions);
  renderFeed();
  
  if (interactions[postId].reposted) {
    showNotification('‚úÖ Reposted to your profile!');
  }
}

function toggleFavorite(postId) {
  const interactions = getInteractions();
  if (!interactions[postId]) {
    interactions[postId] = { liked: false, likes: 0, comments: [], reposts: 0, favorites: 0, favorited: false };
  }
  
  interactions[postId].favorited = !interactions[postId].favorited;
  interactions[postId].favorites += interactions[postId].favorited ? 1 : -1;
  
  saveInteractions(interactions);
  renderFeed();
  
  if (interactions[postId].favorited) {
    showNotification('‚≠ê Added to favorites!');
  }
}

function toggleFollow(postId) {
  const interactions = getInteractions();
  if (!interactions[postId]) {
    interactions[postId] = { liked: false, likes: 0, comments: [], reposts: 0, favorites: 0, following: false };
  }
  
  interactions[postId].following = !interactions[postId].following;
  
  saveInteractions(interactions);
  renderFeed();
  
  if (interactions[postId].following) {
    showNotification('‚úÖ Now following!');
  }
}

function sharePost(postId) {
  showNotification('üì§ Share link copied!');
}

function addToStory(postId) {
  showNotification('üì∏ Added to your story!');
}

function timeAgo(timestamp) {
  const seconds = Math.floor((Date.now() - timestamp) / 1000);
  
  if (seconds < 60) return 'Just now';
  if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;
  if (seconds < 86400) return `${Math.floor(seconds / 3600)}h ago`;
  if (seconds < 604800) return `${Math.floor(seconds / 86400)}d ago`;
  return new Date(timestamp).toLocaleDateString();
}

function showNotification(message) {
  const notification = document.createElement('div');
  notification.style.cssText = `
    position: fixed;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(135deg, #7c3aed, #a855f7);
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    font-weight: 600;
    z-index: 1000;
    box-shadow: 0 4px 20px rgba(124, 58, 237, 0.4);
    animation: slideDown 0.3s ease;
  `;
  notification.textContent = message;
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.style.animation = 'slideUp 0.3s ease';
    setTimeout(() => notification.remove(), 300);
  }, 2000);
}

// Tab switching
$$('.tab').forEach(tab => {
  tab.addEventListener('click', () => {
    $$('.tab').forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    currentTab = tab.dataset.tab;
    renderFeed();
  });
});

// Add animations
const style = document.createElement('style');
style.textContent = `
  @keyframes slideDown {
    from { transform: translateX(-50%) translateY(-20px); opacity: 0; }
    to { transform: translateX(-50%) translateY(0); opacity: 1; }
  }
  @keyframes slideUp {
    from { transform: translateX(-50%) translateY(0); opacity: 1; }
    to { transform: translateX(-50%) translateY(-20px); opacity: 0; }
  }
`;
document.head.appendChild(style);

// ===== INITIALIZATION =====
initializeMockData();
FeedAdSystem.init();
renderFeed();

// ===== HIDE FLOATING BUBBLES & AVATAR =====
window.addEventListener("load", function(){
  setTimeout(function(){
    const idsToHide = ['bubbleStack', 'bubble-top-single', 'carrieWrap', 'carrieBubble', 'carrieToggleBar'];
    idsToHide.forEach(id => {
      const el = document.getElementById(id);
      if (el) el.style.display = 'none';
    });
    
    const classesToHide = ['.bubble-stack', '.floating-bubbles', '.carrie-bubble', '.bubble-container'];
    classesToHide.forEach(cls => {
      document.querySelectorAll(cls).forEach(el => el.style.display = 'none');
    });
    
    document.querySelectorAll('[data-bubble]').forEach(el => el.style.display = 'none');
    document.querySelectorAll('[data-role="carrie"], [data-carrie]').forEach(el => el.style.display = 'none');
  }, 300);
});
</script>

 <!-- ADD THIS SCRIPT TO EVERY PAGE (except index.html where you want it always shown) -->
<!-- Place it right before the closing </body> tag -->

<script>
// Avatar & Bubble Toggle System
(function() {
    // Create toggle button
    const toggleBtn = document.createElement('button');
    toggleBtn.id = 'avatarToggle';
    toggleBtn.innerHTML = 'üëÅÔ∏è';
    toggleBtn.title = 'Toggle Avatar/Bubbles';
    toggleBtn.style.cssText = `
        position: fixed;
        top: 80px;
        right: 20px;
        z-index: 9999;
        background: rgba(124, 58, 237, 0.9);
        border: 2px solid rgba(124, 58, 237, 1);
        color: white;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 12px rgba(124, 58, 237, 0.5);
        transition: all 0.3s ease;
    `;
    
    toggleBtn.addEventListener('mouseenter', function() {
        this.style.transform = 'scale(1.1)';
    });
    
    toggleBtn.addEventListener('mouseleave', function() {
        this.style.transform = 'scale(1)';
    });
    
    document.body.appendChild(toggleBtn);
    
    // Load saved preference
    let isHidden = localStorage.getItem('hideAvatarBubbles') === 'true';
    
    function updateVisibility() {
        const elementsToToggle = [
            document.getElementById('homeAvatarSwitcher'),
            ...document.querySelectorAll('[id*="bubble"]'),
            ...document.querySelectorAll('[class*="bubble"]'),
            ...document.querySelectorAll('[id*="avatar"][id*="switcher"]')
        ];
        
        elementsToToggle.forEach(el => {
            if (el) {
                el.style.display = isHidden ? 'none' : '';
            }
        });
        
        toggleBtn.innerHTML = isHidden ? 'üëÅÔ∏è‚Äçüó®Ô∏è' : 'üëÅÔ∏è';
        toggleBtn.title = isHidden ? 'Show Avatar/Bubbles' : 'Hide Avatar/Bubbles';
    }
    
    toggleBtn.addEventListener('click', function() {
        isHidden = !isHidden;
        localStorage.setItem('hideAvatarBubbles', isHidden);
        updateVisibility();
    });
    
    // Apply on load
    updateVisibility();
    
    // Watch for dynamically added elements
    const observer = new MutationObserver(updateVisibility);
    observer.observe(document.body, { childList: true, subtree: true });
})();
</script>


</body>
</html>
